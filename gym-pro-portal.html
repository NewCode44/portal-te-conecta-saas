<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}} - {{company_name}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- SDKs para integración real de servicios de música -->
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="https://js-cdn.music.apple.com/musickit/v3/musickit.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2196F3;
            --primary-dark: #1976D2;
            --primary-light: #64B5F6;
            --secondary: #1A1A2E;
            --accent: #03DAC6;
            --success: #4CAF50;
            --success-light: #81C784;
            --warning: #FF9800;
            --danger: #F44336;
            --dark: #0F0F23;
            --light: #F5F5F5;
            --white: #FFFFFF;
            --gray: #6C757D;
            --gray-light: #E9ECEF;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--dark) 0%, #1a1a3e 50%, #16213e 100%);
            min-height: 100vh;
            color: var(--white);
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 50%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(3, 218, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(76, 175, 80, 0.05) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundMove 20s ease-in-out infinite;
        }

        @keyframes backgroundMove {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-20px, -20px) scale(1.1); }
        }

        /* Loading animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Login Container */
        .login-container {
            max-width: 440px;
            margin: 80px auto;
            padding: 40px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            box-shadow: 0 10px 25px rgba(33, 150, 243, 0.3);
            transition: transform 0.3s ease;
        }

        .login-logo:hover {
            transform: scale(1.05) rotate(5deg);
        }

        .login-logo i {
            font-size: 40px;
            color: var(--white);
        }

        .login-title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .login-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 8px;
            display: block;
        }

        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 16px 20px;
            font-size: 16px;
            color: var(--white);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
            outline: none;
            color: var(--white);
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .btn-login {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(33, 150, 243, 0.4);
        }

        .btn-login:active {
            transform: translateY(0);
        }

        .btn-login::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-login:hover::before {
            left: 100%;
        }

        /* Main Container */
        .main-container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Header */
        .main-header {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .main-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .user-welcome {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .user-info h1 {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .user-info p {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 0;
        }

        .connection-status {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 24px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: var(--success);
            border-radius: 50%;
            animation: blink 2s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Tabs Navigation */
        .tabs-navigation {
            display: flex;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 8px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }

        .tab-button {
            flex: 1;
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: var(--white);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        /* Cards */
        .card-custom {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .card-custom:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .card-header-custom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title i {
            color: var(--primary);
            font-size: 28px;
        }

        /* Exercise Items */
        .exercise-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .exercise-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(33, 150, 243, 0.3);
            transform: translateX(5px);
        }

        .exercise-item.completed {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--success);
            opacity: 0.8;
        }

        .exercise-gif {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

        .exercise-gif:hover {
            transform: scale(1.05);
        }

        .exercise-details {
            flex: 1;
        }

        .exercise-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--white);
        }

        .exercise-params {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 4px;
        }

        .exercise-weight {
            font-size: 12px;
            color: var(--primary);
            font-weight: 500;
        }

        .btn-complete {
            background: linear-gradient(135deg, var(--success), var(--success-light));
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            color: var(--white);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn-complete:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-complete:disabled {
            background: rgba(255, 255, 255, 0.2);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Progress */
        .progress-container {
            margin-top: 30px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-label {
            font-size: 16px;
            font-weight: 600;
        }

        .progress-percentage {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .progress-bar-custom {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 6px;
            transition: width 0.6s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Music Control */
        .music-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .music-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
        }

        .music-card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .music-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #1DB954, #1ED760);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 24px;
            color: var(--white);
        }

        .music-card.apple .music-icon {
            background: linear-gradient(135deg, #000000, #333333);
        }

        .music-card.youtube .music-icon {
            background: linear-gradient(135deg, #FF0000, #CC0000);
        }

        .music-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .music-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Timer */
        .timer-display {
            font-size: 48px;
            font-weight: 700;
            text-align: center;
            margin: 24px 0;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-variant-numeric: tabular-nums;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .timer-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        /* Promo Banner */
        .promo-banner {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .promo-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-20px, -20px); }
        }

        .promo-content {
            position: relative;
            z-index: 1;
        }

        .promo-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .promo-description {
            font-size: 16px;
            margin-bottom: 16px;
            opacity: 0.9;
        }

        .promo-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            display: inline-block;
        }

        /* Quick Info */
        .info-list {
            list-style: none;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 18px;
        }

        .info-text {
            flex: 1;
        }

        .info-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 2px;
        }

        .info-value {
            font-size: 16px;
            font-weight: 500;
        }

        /* Access Button */
        .access-section {
            text-align: center;
            margin-top: 30px;
        }

        .btn-access {
            background: linear-gradient(135deg, var(--success), var(--success-light));
            border: none;
            border-radius: 16px;
            padding: 20px 40px;
            font-size: 18px;
            font-weight: 700;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            gap: 12px;
        }

        .btn-access:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(76, 175, 80, 0.4);
        }

        .btn-access::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-access:hover::before {
            left: 100%;
        }

        .access-hint {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 12px;
        }

        /* Access Granted */
        .access-granted {
            display: none;
            text-align: center;
            padding: 60px;
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 24px;
            margin: 60px auto;
            max-width: 600px;
            animation: scaleIn 0.6s ease-out;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .success-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--success), var(--success-light));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 48px;
            color: var(--white);
            animation: bounceIn 0.8s ease-out;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Records Widget */
        .records-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .record-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .record-exercise {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .record-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .record-date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Calendar Widget */
        .calendar-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .calendar-nav {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            width: 36px;
            height: 36px;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-nav:hover {
            background: var(--primary);
        }

        .calendar-month {
            font-size: 18px;
            font-weight: 600;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-day:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .calendar-day.today {
            background: var(--primary);
            font-weight: 600;
        }

        .calendar-day.workout {
            position: relative;
        }

        .calendar-day.workout::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: var(--success);
            border-radius: 50%;
        }

        /* Videos Widget */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
        }

        .video-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .video-iframe {
            width: 100%;
            height: 200px;
            border: none;
        }

        .video-title {
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
        }

        /* Exercise Modal */
        .exercise-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--dark);
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            padding: 20px 24px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h4 {
            margin: 0;
            color: var(--primary);
            font-size: 18px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-body .form-group {
            margin-bottom: 20px;
        }

        .modal-body label {
            display: block;
            margin-bottom: 8px;
            color: var(--white);
            font-size: 14px;
            font-weight: 500;
        }

        .modal-body input,
        .modal-body select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .modal-body input:focus,
        .modal-body select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.15);
        }

        .modal-footer {
            padding: 16px 24px 24px;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .btn-secondary {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-primary {
            padding: 10px 20px;
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            padding: 10px 20px;
            background: var(--success);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-success:hover {
            background: var(--success-light);
        }

        /* Rest Timer Notification */
        .rest-timer-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, var(--warning), #FFB74D);
            color: var(--white);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            z-index: 9999;
            animation: slideInRight 0.3s ease;
        }

        .rest-content {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .rest-content i {
            font-size: 18px;
        }

        .skip-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: var(--white);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .skip-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Workout Summary */
        .workout-summary {
            text-align: center;
            padding: 20px;
        }

        .workout-summary h3 {
            color: var(--success);
            margin-bottom: 16px;
            font-size: 20px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .summary-stats .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        .achievement-summary {
            display: flex;
            justify-content: space-around;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .streak-info, .total-workouts {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Achievement System */
        .achievement-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 15000;
            animation: slideInScale 0.5s ease-out;
        }

        .achievement-popup {
            background: linear-gradient(135deg, var(--success), var(--success-light));
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-width: 320px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .achievement-header {
            font-size: 18px;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .achievement-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .achievement-icon-large {
            font-size: 48px;
            animation: bounceIn 0.8s ease-out;
        }

        .achievement-details {
            flex: 1;
            text-align: left;
        }

        .achievement-name-large {
            font-size: 20px;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 8px;
        }

        .achievement-description-large {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
        }

        .achievement-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .achievement-item.unlocked {
            background: rgba(76, 175, 80, 0.2);
            border-color: var(--success);
        }

        .achievement-item.locked {
            opacity: 0.6;
        }

        .achievement-icon {
            font-size: 24px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 4px;
        }

        .achievement-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.3;
        }

        .achievement-unlocked {
            font-size: 20px;
            color: var(--success);
        }

        /* Streak Counter */
        .streak-counter {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .streak-number {
            font-size: 36px;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .streak-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
        }

        .streak-fire {
            font-size: 24px;
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Music Player Widget */
        .music-widget {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .music-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .music-header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .music-header h4 {
            margin: 0;
            color: var(--primary);
            font-size: 16px;
            font-weight: 600;
        }

        .bpm {
            background: var(--accent);
            color: var(--dark);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .current-track {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .track-info {
            flex: 1;
        }

        .track-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 4px;
        }

        .track-artist {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        .track-duration {
            color: var(--accent);
            font-weight: 600;
            font-size: 14px;
        }

        .music-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            color: var(--white);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        .control-btn.main-control {
            background: var(--primary);
            width: 56px;
            height: 56px;
            font-size: 20px;
        }

        .control-btn.main-control:hover {
            background: var(--primary-dark);
        }

        .playlist-controls {
            display: flex;
            gap: 8px;
        }

        .playlist-btn {
            flex: 1;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .playlist-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .playlist-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        /* Music Services */
        .music-services {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .service-btn {
            flex: 1;
            padding: 10px 8px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
        }

        .service-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .service-btn.connected {
            background: var(--success);
            border-color: var(--success);
            color: var(--white);
        }

        .service-btn.spotify.connected {
            background: #1DB954;
        }

        .service-btn.apple.connected {
            background: #FC3C44;
        }

        .service-btn.youtube.connected {
            background: #FF0000;
        }

        /* Service Badge */
        .service-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .service-badge.spotify {
            background: #1DB954;
            color: white;
        }

        .service-badge.appleMusic {
            background: #FC3C44;
            color: white;
        }

        .service-badge.youtubeMusic {
            background: #FF0000;
            color: white;
        }

        /* Service Playlists */
        .service-playlists {
            margin-top: 16px;
        }

        .service-playlists h4 {
            color: var(--primary);
            font-size: 14px;
            margin-bottom: 12px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
        }

        .playlist-info {
            flex: 1;
        }

        .playlist-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 4px;
        }

        .playlist-details {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .playlist-play {
            font-size: 16px;
            color: var(--accent);
        }

        .connect-notice {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            font-style: italic;
            margin: 20px 0;
        }

        /* Music Login Modal */
        .music-login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content-music {
            background: var(--dark);
            border-radius: 16px;
            width: 90%;
            max-width: 350px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header-music {
            padding: 16px 20px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header-music h4 {
            margin: 0;
            color: var(--primary);
            font-size: 18px;
            font-weight: 600;
        }

        .modal-body-music {
            padding: 20px;
            text-align: center;
        }

        .service-logo {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .spotify-icon, .apple-music-icon, .youtube-music-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 24px;
            font-weight: bold;
        }

        .spotify-icon {
            background: #1DB954;
            color: white;
        }

        .apple-music-icon {
            background: #FC3C44;
            color: white;
        }

        .youtube-music-icon {
            background: #FF0000;
            color: white;
        }

        .login-form-music {
            margin: 20px 0;
        }

        .music-input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .music-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.15);
        }

        .music-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .auth-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin: 16px 0;
            border-left: 3px solid var(--success);
        }

        .auth-info p {
            margin: 0;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .modal-footer-music {
            padding: 16px 24px 24px;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Volume Control Modal */
        .volume-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .volume-content {
            background: var(--dark);
            border-radius: 16px;
            padding: 24px;
            min-width: 300px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .volume-content h4 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .volume-slider {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
            appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .equalizer h5 {
            color: var(--white);
            margin-bottom: 16px;
            font-size: 14px;
        }

        .eq-controls {
            display: flex;
            gap: 16px;
        }

        .eq-band {
            flex: 1;
            text-align: center;
        }

        .eq-band label {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            margin-bottom: 8px;
        }

        .eq-slider {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            outline: none;
            appearance: none;
        }

        .eq-slider::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            background: var(--accent);
            border-radius: 50%;
            cursor: pointer;
        }

        /* Podcasts Widget */
        .podcast-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .podcast-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .podcast-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .podcast-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--white);
        }

        .podcast-info {
            flex: 1;
        }

        .podcast-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .podcast-episode {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        .btn-play {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-play:hover {
            background: var(--primary);
        }

        /* Classes Widget */
        .classes-schedule {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .class-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .class-info {
            flex: 1;
        }

        .class-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .class-time {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 2px;
        }

        .class-instructor {
            font-size: 12px;
            color: var(--primary);
        }

        .btn-reserve {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            color: var(--white);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-reserve:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }

        /* Store Widget */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .product-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .product-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-light);
        }

        .product-image {
            width: 100%;
            height: 120px;
            border-radius: 8px;
            object-fit: cover;
            margin-bottom: 12px;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .product-price {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .btn-buy {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            color: var(--white);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn-buy:hover {
            background: var(--primary);
        }

        /* Trainer Widget */
        .trainer-featured {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .trainer-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary);
        }

        .trainer-info {
            flex: 1;
        }

        .trainer-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .trainer-specialty {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .trainer-bio {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Rating Widget */
        .rating-container {
            text-align: center;
        }

        .stars-rating {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 16px;
        }

        .stars-rating i {
            font-size: 32px;
            color: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stars-rating i:hover,
        .stars-rating i.active {
            color: var(--warning);
        }

        .rating-textarea {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 16px;
            color: var(--white);
            width: 100%;
            margin-bottom: 16px;
            resize: none;
            min-height: 100px;
        }

        .rating-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        .btn-submit-rating {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            border-radius: 12px;
            padding: 12px 32px;
            color: var(--white);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-submit-rating:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }

        /* Nutrition Widget */
        .nutrition-tip {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tip-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .tip-content {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .tip-recipe {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
        }

        .tip-recipe strong {
            color: var(--accent);
        }

        /* Challenge Widget */
        .challenge-info {
            text-align: center;
        }

        .challenge-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--primary);
        }

        .challenge-progress {
            margin-top: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .challenge-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Leaderboard Widget */
        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .leaderboard-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leaderboard-item:nth-child(1) {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
        }

        .leaderboard-item:nth-child(2) {
            background: rgba(192, 192, 192, 0.1);
            border-color: rgba(192, 192, 192, 0.3);
        }

        .leaderboard-item:nth-child(3) {
            background: rgba(205, 127, 50, 0.1);
            border-color: rgba(205, 127, 50, 0.3);
        }

        .rank {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
        }

        .leaderboard-item:nth-child(1) .rank {
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .leaderboard-item:nth-child(2) .rank {
            background: linear-gradient(135deg, #C0C0C0, #A9A9A9);
        }

        .leaderboard-item:nth-child(3) .rank {
            background: linear-gradient(135deg, #CD7F32, #8B4513);
        }

        .leaderboard-name {
            flex: 1;
            font-size: 16px;
            font-weight: 600;
        }

        .leaderboard-score {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: var(--white);
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                margin: 40px 20px;
                padding: 30px 20px;
            }

            .user-welcome {
                flex-direction: column;
                text-align: center;
            }

            .user-info h1 {
                font-size: 28px;
            }

            .exercise-item {
                flex-direction: column;
                text-align: center;
            }

            .exercise-gif {
                margin-bottom: 16px;
            }

            .timer-display {
                font-size: 36px;
            }

            .music-grid {
                grid-template-columns: 1fr;
            }

            .tabs-navigation {
                flex-wrap: nowrap;
                overflow-x: auto;
            }

            .tab-button {
                flex: 0 0 auto;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        .slide-up {
            animation: slideUp 0.6s ease-out;
        }

        .scale-in {
            animation: scaleIn 0.6s ease-out;
        }

        /* Enhanced Music Authentication Modal Styles */
        .service-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .service-logo-large {
            font-size: 48px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
        }

        .service-description {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .auth-options h5 {
            color: var(--white);
            margin-bottom: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .social-auth-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .social-btn-compact {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .social-btn-compact:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .social-icon-compact {
            font-size: 20px;
        }

        /* Estilos específicos para cada proveedor */
        .social-btn-compact[onclick*="google"]:hover {
            background: rgba(219, 68, 55, 0.2);
            border-color: rgba(219, 68, 55, 0.4);
        }

        .social-btn-compact[onclick*="facebook"]:hover {
            background: rgba(24, 119, 242, 0.2);
            border-color: rgba(24, 119, 242, 0.4);
        }

        .social-btn-compact[onclick*="apple"]:hover {
            background: rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .social-btn-compact[onclick*="youtube"]:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.4);
        }

        .divider {
            position: relative;
            text-align: center;
            margin: 24px 0;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .divider span {
            background: var(--dark);
            color: rgba(255, 255, 255, 0.6);
            padding: 0 16px;
            font-size: 14px;
            position: relative;
        }

        .manual-login h6 {
            color: var(--white);
            margin-bottom: 16px;
            font-size: 14px;
            font-weight: 600;
        }

        .login-form-music {
            margin-bottom: 16px;
        }

        .login-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
        }

        .remember-me input {
            width: auto;
            margin: 0;
        }

        .forgot-password {
            color: var(--primary);
            text-decoration: none;
            font-size: 12px;
            transition: opacity 0.3s ease;
        }

        .forgot-password:hover {
            opacity: 0.8;
        }

        .btn-secondary {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--white);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-primary {
            padding: 10px 20px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-outline {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Service-Specific Player Styles */
        .service-player {
            background: var(--dark);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .player-header {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .service-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .service-logo {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }

        .service-details h4 {
            margin: 0 0 4px 0;
            color: var(--white);
            font-size: 16px;
            font-weight: 600;
        }

        .service-details p {
            margin: 0;
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
        }

        .disconnect-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .disconnect-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .player-content {
            padding: 20px;
        }

        /* Spotify Player Styles */
        .spotify-interface .now-playing {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(29, 185, 84, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(29, 185, 84, 0.2);
        }

        .spotify-interface .album-art {
            width: 60px;
            height: 60px;
            background: #1DB954;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .spotify-interface .track-info {
            flex: 1;
        }

        .spotify-interface .track-title {
            color: var(--white);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .spotify-interface .track-artist {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 2px;
        }

        .spotify-interface .track-album {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        .spotify-interface .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .spotify-interface .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .spotify-interface .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .spotify-interface .main-play {
            background: #1DB954;
            color: white;
            width: 56px;
            height: 56px;
            font-size: 24px;
        }

        .spotify-interface .main-play:hover {
            background: #1ed760;
            transform: scale(1.05);
        }

        .spotify-interface .progress-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .spotify-interface .time-current,
        .spotify-interface .time-total {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            min-width: 35px;
        }

        .spotify-interface .progress-track {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .spotify-interface .progress-fill {
            height: 100%;
            background: #1DB954;
            transition: width 0.3s ease;
        }

        .spotify-interface .spotify-playlists h5 {
            color: var(--white);
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 600;
        }

        .spotify-interface .playlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }

        .spotify-interface .playlist-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .spotify-interface .playlist-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .spotify-interface .playlist-cover {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .spotify-interface .playlist-name {
            color: var(--white);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .spotify-interface .playlist-tracks {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        /* Apple Music Player Styles */
        .apple-interface .apple-now-playing {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(252, 60, 68, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(252, 60, 68, 0.2);
        }

        .apple-interface .apple-album-art {
            width: 60px;
            height: 60px;
            background: #FC3C44;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .apple-interface .apple-track-info {
            flex: 1;
        }

        .apple-interface .apple-track-title {
            color: var(--white);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .apple-interface .apple-track-artist {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 2px;
        }

        .apple-interface .apple-track-album {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        .apple-interface .apple-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .apple-interface .apple-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .apple-interface .apple-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .apple-interface .apple-play {
            background: #FC3C44;
            color: white;
            width: 56px;
            height: 56px;
            font-size: 24px;
        }

        .apple-interface .apple-play:hover {
            background: #ff4757;
            transform: scale(1.05);
        }

        .apple-interface .apple-progress {
            margin-bottom: 24px;
        }

        .apple-interface .apple-time {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            text-align: center;
            margin-bottom: 8px;
        }

        .apple-interface .apple-progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .apple-interface .apple-progress-fill {
            height: 100%;
            background: #FC3C44;
            transition: width 0.3s ease;
        }

        .apple-interface .apple-stations h5 {
            color: var(--white);
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 600;
        }

        .apple-interface .station-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .apple-interface .station-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .apple-interface .station-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
        }

        .apple-interface .station-icon {
            font-size: 20px;
        }

        .apple-interface .station-name {
            color: var(--white);
            font-size: 14px;
            font-weight: 500;
        }

        /* YouTube Music Player Styles */
        .youtube-interface .youtube-video-player {
            margin-bottom: 20px;
        }

        .youtube-interface .video-thumbnail {
            position: relative;
            width: 100%;
            height: 180px;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 0, 0, 0.2);
            margin-bottom: 12px;
            overflow: hidden;
        }

        .youtube-interface .video-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: rgba(255, 255, 255, 0.6);
            background: linear-gradient(135deg, #FF0000, #CC0000);
        }

        .youtube-interface .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .youtube-interface .video-thumbnail:hover .video-overlay {
            opacity: 1;
        }

        .youtube-interface .youtube-play-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #FF0000;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .youtube-interface .youtube-play-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        .youtube-interface .video-info {
            padding: 0 8px;
        }

        .youtube-interface .video-title {
            color: var(--white);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .youtube-interface .video-artist {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
        }

        .youtube-interface .youtube-controls {
            margin-bottom: 24px;
        }

        .youtube-interface .youtube-progress {
            margin-bottom: 16px;
        }

        .youtube-interface .youtube-progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
            margin-bottom: 8px;
        }

        .youtube-interface .youtube-progress-fill {
            height: 100%;
            background: #FF0000;
            transition: width 0.3s ease;
        }

        .youtube-interface .youtube-time {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            text-align: center;
        }

        .youtube-interface .youtube-buttons {
            display: flex;
            justify-content: center;
            gap: 16px;
        }

        .youtube-interface .youtube-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .youtube-interface .youtube-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .youtube-interface .youtube-queue h5 {
            color: var(--white);
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 600;
        }

        .youtube-interface .queue-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .youtube-interface .queue-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .youtube-interface .queue-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
        }

        .youtube-interface .queue-thumb {
            width: 40px;
            height: 40px;
            background: rgba(255, 0, 0, 0.2);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #FF0000;
        }

        .youtube-interface .queue-info {
            flex: 1;
        }

        .youtube-interface .queue-title {
            color: var(--white);
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .youtube-interface .queue-artist {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
        }

        .youtube-interface .queue-duration {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        /* Responsive adjustments for service players */
        @media (max-width: 768px) {
            .spotify-interface .playlist-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .youtube-interface .video-thumbnail {
                height: 140px;
            }

            .apple-interface .apple-controls {
                gap: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">¡Ejercicio completado!</span>
    </div>

    <!-- Login Form -->
    <div id="loginContainer" class="login-container">
        <div class="login-header">
            <div class="login-logo">
                <i class="fas fa-dumbbell"></i>
            </div>
            <h2 class="login-title"></h2>
            <p class="login-subtitle">Portal de Acceso Miembros</p>
        </div>

        <form id="loginForm" action="{{login_url}}" method="POST">
            <div class="form-group">
                <label class="form-label" for="username">
                    <i class="fas fa-user me-2"></i>Usuario o Email
                </label>
                <input type="text" class="form-control" id="username" name="username" placeholder="Ingresa tu usuario" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="password">
                    <i class="fas fa-lock me-2"></i>Contraseña
                </label>
                <input type="password" class="form-control" id="password" name="password" placeholder="Ingresa tu contraseña" required>
            </div>
            <button type="submit" class="btn-login">
                <i class="fas fa-sign-in-alt me-2"></i>Iniciar Sesión
            </button>
        </form>

        <div class="text-center mt-4">
            <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>
                ¿Olvidaste tu contraseña? Contacta a recepción
            </small>
        </div>
    </div>

    <!-- Main Portal Content -->
    <div id="mainContainer" class="main-container">
        <!-- Header -->
        <div class="main-header">
            <div class="header-content">
                <div class="user-welcome">
                    <div class="user-info">
                        <h1><i class="fas fa-dumbbell me-3"></i>Gym Pro</h1>
                        <p>¡Bienvenido de nuevo, <span id="userName">Miembro</span>!</p>
                    </div>
                    <div class="connection-status">
                        <div class="status-dot"></div>
                        <span>Conectado a {{company_name}}_WiFi</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs-navigation">
            <button class="tab-button active" onclick="switchTab('routine')">
                <i class="fas fa-dumbbell"></i>
                Rutina
            </button>
            <button class="tab-button" onclick="switchTab('progress')">
                <i class="fas fa-chart-line"></i>
                Progreso
            </button>
            <button class="tab-button" onclick="switchTab('community')">
                <i class="fas fa-users"></i>
                Comunidad
            </button>
            <button class="tab-button" onclick="switchTab('store')">
                <i class="fas fa-shopping-cart"></i>
                Tienda
            </button>
        </div>

        <!-- Tab Content: Routine -->
        <div id="routine-tab" class="tab-content active">
            <div class="row">
                <div class="col-lg-8">
                    <!-- Today's Routine -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-clipboard-list"></i>
                                Mi Rutina de Hoy
                            </h3>
                            <span class="badge bg-warning text-dark">Día de Pierna + Cardio</span>
                        </div>

                        <div id="exerciseList">
                            <!-- Exercise 1 -->
                            <div class="exercise-item" data-exercise="1">
                                <img src="https://picsum.photos/seed/squat/100/100.jpg" alt="Sentadillas" class="exercise-gif">
                                <div class="exercise-details">
                                    <h4 class="exercise-name">Sentadillas</h4>
                                    <p class="exercise-params">4 series x 12 repeticiones</p>
                                    <p class="exercise-weight">Peso sugerido: 60kg</p>
                                </div>
                                <button class="btn-complete" onclick="completeExercise(this, 1)">
                                    <i class="fas fa-check me-2"></i>Completar
                                </button>
                            </div>

                            <!-- Exercise 2 -->
                            <div class="exercise-item" data-exercise="2">
                                <img src="https://picsum.photos/seed/lunge/100/100.jpg" alt="Zancadas" class="exercise-gif">
                                <div class="exercise-details">
                                    <h4 class="exercise-name">Zancadas</h4>
                                    <p class="exercise-params">3 series x 10 repeticiones</p>
                                    <p class="exercise-weight">Peso sugerido: 15kg</p>
                                </div>
                                <button class="btn-complete" onclick="completeExercise(this, 2)">
                                    <i class="fas fa-check me-2"></i>Completar
                                </button>
                            </div>

                            <!-- Exercise 3 -->
                            <div class="exercise-item" data-exercise="3">
                                <img src="https://picsum.photos/seed/legpress/100/100.jpg" alt="Prensa de Piernas" class="exercise-gif">
                                <div class="exercise-details">
                                    <h4 class="exercise-name">Prensa de Piernas</h4>
                                    <p class="exercise-params">4 series x 15 repeticiones</p>
                                    <p class="exercise-weight">Peso sugerido: 80kg</p>
                                </div>
                                <button class="btn-complete" onclick="completeExercise(this, 3)">
                                    <i class="fas fa-check me-2"></i>Completar
                                </button>
                            </div>

                            <!-- Exercise 4 -->
                            <div class="exercise-item" data-exercise="4">
                                <img src="https://picsum.photos/seed/treadmill/100/100.jpg" alt="Cardio" class="exercise-gif">
                                <div class="exercise-details">
                                    <h4 class="exercise-name">Cardio - Cinta</h4>
                                    <p class="exercise-params">20 minutos</p>
                                    <p class="exercise-weight">Velocidad: 8km/h</p>
                                </div>
                                <button class="btn-complete" onclick="completeExercise(this, 4)">
                                    <i class="fas fa-check me-2"></i>Completar
                                </button>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div class="progress-container">
                            <div class="progress-header">
                                <span class="progress-label">Progreso del Entrenamiento</span>
                                <span class="progress-percentage" id="progressText">0%</span>
                            </div>
                            <div class="progress-bar-custom">
                                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Music Control -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-music"></i>
                                Música para Entrenar
                            </h3>
                        </div>
                        <p class="text-muted mb-4">Elige tu playlist y mantén la energía al máximo</p>

                        <div class="music-grid">
                            <div class="music-card" onclick="openSpotify()">
                                <div class="music-icon">
                                    <i class="fab fa-spotify"></i>
                                </div>
                                <h5 class="music-title">Beast Mode</h5>
                                <p class="music-subtitle">Spotify</p>
                            </div>
                            <div class="music-card apple" onclick="openAppleMusic()">
                                <div class="music-icon">
                                    <i class="fab fa-apple"></i>
                                </div>
                                <h5 class="music-title">Cardio Hits</h5>
                                <p class="music-subtitle">Apple Music</p>
                            </div>
                            <div class="music-card youtube" onclick="openYouTubeMusic()">
                                <div class="music-icon">
                                    <i class="fab fa-youtube"></i>
                                </div>
                                <h5 class="music-title">Workout Mix</h5>
                                <p class="music-subtitle">YouTube Music</p>
                            </div>
                        </div>
                    </div>

                    <!-- Videos de Técnica -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fab fa-youtube"></i>
                                Videos de Técnica
                            </h3>
                        </div>
                        <div class="video-grid">
                            <div class="video-item">
                                <iframe class="video-iframe" src="https://www.youtube.com/embed/UXJrQtO7iSk" allowfullscreen></iframe>
                                <div class="video-title">Técnica perfecta de sentadillas</div>
                            </div>
                            <div class="video-item">
                                <iframe class="video-iframe" src="https://www.youtube.com/embed/3OKfX7j5jvY" allowfullscreen></iframe>
                                <div class="video-title">Zancadas correctas</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <!-- Timer -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h5 class="card-title">
                                <i class="fas fa-stopwatch"></i>
                                Cronómetro
                            </h5>
                        </div>
                        <div class="timer-display" id="timer">00:00</div>
                        <div class="timer-controls">
                            <button class="timer-btn" onclick="startTimer()">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="timer-btn" onclick="pauseTimer()">
                                <i class="fas fa-pause"></i>
                            </button>
                            <button class="timer-btn" onclick="resetTimer()">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Quick Info -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h5 class="card-title">
                                <i class="fas fa-info-circle"></i>
                                Información Rápida
                            </h5>
                        </div>
                        <ul class="info-list">
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Horario</div>
                                    <div class="info-value">5:00 AM - 11:00 PM</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Aforo</div>
                                    <div class="info-value">65/100 personas</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-spa"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Sauna</div>
                                    <div class="info-value">Disponible</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Recepción</div>
                                    <div class="info-value">Ext. 101</div>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Promo Banner -->
                    <div class="promo-banner">
                        <div class="promo-content">
                            <h4 class="promo-title">
                                <i class="fas fa-fire me-2"></i>Oferta del Día
                            </h4>
                            <p class="promo-description">¡20% de descuento en todos los suplementos!</p>
                            <span class="promo-badge">Válido solo hoy</span>
                        </div>
                    </div>

                    <!-- Get Internet Access -->
                    <div class="access-section">
                        <button class="btn-access" onclick="grantAccess()">
                            <i class="fas fa-wifi"></i>
                            Obtener Acceso a Internet
                        </button>
                        <p class="access-hint">Completa tu rutina para acceso completo</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Progress -->
        <div id="progress-tab" class="tab-content">
            <div class="row">
                <div class="col-lg-6">
                    <!-- Records Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-trophy"></i>
                                Mis Récords Personales
                            </h3>
                        </div>
                        <div class="records-grid">
                            <div class="record-item">
                                <div class="record-exercise">Sentadillas</div>
                                <div class="record-value">80 kg</div>
                                <div class="record-date">15/10/2024</div>
                            </div>
                            <div class="record-item">
                                <div class="record-exercise">Press Banca</div>
                                <div class="record-value">70 kg</div>
                                <div class="record-date">10/10/2024</div>
                            </div>
                            <div class="record-item">
                                <div class="record-exercise">Peso Muerto</div>
                                <div class="record-value">100 kg</div>
                                <div class="record-date">05/10/2024</div>
                            </div>
                            <div class="record-item">
                                <div class="record-exercise">Dominadas</div>
                                <div class="record-value">12 reps</div>
                                <div class="record-date">01/10/2024</div>
                            </div>
                        </div>
                    </div>

                    <!-- Calendar Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-calendar-alt"></i>
                                Calendario de Entrenamiento
                            </h3>
                        </div>
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button class="calendar-nav">❮</button>
                                <span class="calendar-month">Noviembre 2024</span>
                                <button class="calendar-nav">❯</button>
                            </div>
                            <div class="calendar-grid">
                                <div class="calendar-day">L</div>
                                <div class="calendar-day">M</div>
                                <div class="calendar-day">X</div>
                                <div class="calendar-day">J</div>
                                <div class="calendar-day">V</div>
                                <div class="calendar-day">S</div>
                                <div class="calendar-day">D</div>

                                <div class="calendar-day"></div>
                                <div class="calendar-day"></div>
                                <div class="calendar-day"></div>
                                <div class="calendar-day"></div>
                                <div class="calendar-day">1</div>
                                <div class="calendar-day">2</div>
                                <div class="calendar-day">3</div>

                                <div class="calendar-day">4</div>
                                <div class="calendar-day">5</div>
                                <div class="calendar-day workout">6</div>
                                <div class="calendar-day">7</div>
                                <div class="calendar-day workout">8</div>
                                <div class="calendar-day">9</div>
                                <div class="calendar-day">10</div>

                                <div class="calendar-day">11</div>
                                <div class="calendar-day workout">12</div>
                                <div class="calendar-day">13</div>
                                <div class="calendar-day workout">14</div>
                                <div class="calendar-day today">15</div>
                                <div class="calendar-day">16</div>
                                <div class="calendar-day">17</div>

                                <div class="calendar-day">18</div>
                                <div class="calendar-day workout">19</div>
                                <div class="calendar-day">20</div>
                                <div class="calendar-day workout">21</div>
                                <div class="calendar-day workout">22</div>
                                <div class="calendar-day">23</div>
                                <div class="calendar-day">24</div>
                            </div>
                        </div>
                    </div>

                    <!-- Challenge Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-flag-checkered"></i>
                                Reto del Mes
                            </h3>
                        </div>
                        <div class="challenge-info">
                            <div class="challenge-title">Reto de los 200 km en cinta</div>
                            <div class="challenge-progress">
                                <div class="progress-info">
                                    <span>Tu progreso: 45 km</span>
                                    <span>22.5%</span>
                                </div>
                                <div class="progress-bar-custom">
                                    <div class="progress-fill" style="width: 22.5%"></div>
                                </div>
                            </div>
                            <div class="challenge-stats">
                                <div class="stat-item">
                                    <div class="stat-value">45</div>
                                    <div class="stat-label">km completados</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">155</div>
                                    <div class="stat-label">km restantes</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">16</div>
                                    <div class="stat-label">días restantes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <!-- Leaderboard Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-medal"></i>
                                Tabla de Clasificación
                            </h3>
                        </div>
                        <div class="leaderboard-list">
                            <div class="leaderboard-item">
                                <div class="rank">1</div>
                                <div class="leaderboard-name">Ana Martínez</div>
                                <div class="leaderboard-score">2,450 pts</div>
                            </div>
                            <div class="leaderboard-item">
                                <div class="rank">2</div>
                                <div class="leaderboard-name">Carlos López</div>
                                <div class="leaderboard-score">2,380 pts</div>
                            </div>
                            <div class="leaderboard-item">
                                <div class="rank">3</div>
                                <div class="leaderboard-name">María García</div>
                                <div class="leaderboard-score">2,290 pts</div>
                            </div>
                            <div class="leaderboard-item">
                                <div class="rank">4</div>
                                <div class="leaderboard-name">Juan Pérez</div>
                                <div class="leaderboard-score">2,150 pts</div>
                            </div>
                            <div class="leaderboard-item">
                                <div class="rank">5</div>
                                <div class="leaderboard-name">Laura Sánchez</div>
                                <div class="leaderboard-score">2,080 pts</div>
                            </div>
                        </div>
                    </div>

                    <!-- Classes Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Reservar Clase
                            </h3>
                        </div>
                        <div class="classes-schedule">
                            <div class="class-item">
                                <div class="class-info">
                                    <div class="class-name">Yoga</div>
                                    <div class="class-time">18:00 - 19:00</div>
                                    <div class="class-instructor">María García</div>
                                </div>
                                <button class="btn-reserve">Reservar</button>
                            </div>
                            <div class="class-item">
                                <div class="class-info">
                                    <div class="class-name">Spinning</div>
                                    <div class="class-time">19:00 - 20:00</div>
                                    <div class="class-instructor">Carlos Rodríguez</div>
                                </div>
                                <button class="btn-reserve">Reservar</button>
                            </div>
                            <div class="class-item">
                                <div class="class-info">
                                    <div class="class-name">Pilates</div>
                                    <div class="class-time">20:00 - 21:00</div>
                                    <div class="class-instructor">Ana López</div>
                                </div>
                                <button class="btn-reserve">Reservar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Nutrition Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-apple-alt"></i>
                                Consejo Nutricional
                            </h3>
                        </div>
                        <div class="nutrition-tip">
                            <div class="tip-title">Proteína post-entreno</div>
                            <div class="tip-content">
                                Consume 20-30g de proteína dentro de los 30 minutos posteriores a tu entrenamiento para maximizar la recuperación muscular. La proteína de suero es ideal por su rápida absorción.
                            </div>
                            <div class="tip-recipe">
                                <strong>Receta rápida:</strong> Batido de plátano con proteína, leche y una cucharada de miel.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Community -->
        <div id="community-tab" class="tab-content">
            <div class="row">
                <div class="col-lg-6">
                    <!-- Trainer Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-user-tie"></i>
                                Entrenador del Mes
                            </h3>
                        </div>
                        <div class="trainer-featured">
                            <img src="https://picsum.photos/seed/trainer/100/100.jpg" alt="Entrenador" class="trainer-image">
                            <div class="trainer-info">
                                <div class="trainer-name">Carlos Rodríguez</div>
                                <div class="trainer-specialty">Especialista en Fuerza</div>
                                <div class="trainer-bio">
                                    Con más de 10 años de experiencia, Carlos es experto en entrenamiento de fuerza y acondicionamiento físico. Certificado en CrossFit Level 2 y preparador físico nacional.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rating Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-star"></i>
                                ¿Cómo fue tu visita?
                            </h3>
                        </div>
                        <div class="rating-container">
                            <div class="stars-rating">
                                <i class="far fa-star" onclick="rateStar(1)"></i>
                                <i class="far fa-star" onclick="rateStar(2)"></i>
                                <i class="far fa-star" onclick="rateStar(3)"></i>
                                <i class="far fa-star" onclick="rateStar(4)"></i>
                                <i class="far fa-star" onclick="rateStar(5)"></i>
                            </div>
                            <textarea class="rating-textarea" placeholder="Comentarios adicionales..."></textarea>
                            <button class="btn-submit-rating" onclick="submitRating()">Enviar</button>
                        </div>
                    </div>

                    <!-- Podcasts Widget -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-podcast"></i>
                                Podcasts Recomendados
                            </h3>
                        </div>
                        <div class="podcast-list">
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-microphone"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">Fitness Revolucionario</div>
                                    <div class="podcast-episode">Ep 45: Nutrición para ganancia muscular</div>
                                </div>
                                <button class="btn-play">▶️</button>
                            </div>
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-microphone"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">Vida Sana</div>
                                    <div class="podcast-episode">Ep 23: Suplementos que realmente funcionan</div>
                                </div>
                                <button class="btn-play">▶️</button>
                            </div>
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-microphone"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">Mente Fuerte</div>
                                    <div class="podcast-episode">Ep 67: Superar mesetas en el entrenamiento</div>
                                </div>
                                <button class="btn-play">▶️</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <!-- Promo Banner -->
                    <div class="promo-banner">
                        <div class="promo-content">
                            <h4 class="promo-title">
                                <i class="fas fa-users me-2"></i>
                                Evento Comunitario
                            </h4>
                            <p class="promo-description">¡Sábado de CrossFit para toda la familia!</p>
                            <p class="promo-description">Este sábado 10:00 AM</p>
                            <span class="promo-badge">Inscripción gratuita</span>
                        </div>
                    </div>

                    <!-- Community Stats -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-chart-bar"></i>
                                Estadísticas de la Comunidad
                            </h3>
                        </div>
                        <div class="challenge-stats">
                            <div class="stat-item">
                                <div class="stat-value">156</div>
                                <div class="stat-label">Miembros activos</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">2,340</div>
                                <div class="stat-label">Entrenamientos este mes</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">89%</div>
                                <div class="stat-label">Satisfacción</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">24</div>
                                <div class="stat-label">Clases disponibles</div>
                            </div>
                        </div>
                    </div>

                    <!-- Social Feed -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-comments"></i>
                                Actividad Reciente
                            </h3>
                        </div>
                        <div class="podcast-list">
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">¡Nuevo récord!</div>
                                    <div class="podcast-episode">Ana Martínez superó las 100 sentadillas</div>
                                </div>
                            </div>
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">Clase llena</div>
                                    <div class="podcast-episode">Yoga de mañana está completo</div>
                                </div>
                            </div>
                            <div class="podcast-item">
                                <div class="podcast-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="podcast-info">
                                    <div class="podcast-title">Excelente servicio</div>
                                    <div class="podcast-episode">Carlos calificó con 5 estrellas</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Store -->
        <div id="store-tab" class="tab-content">
            <div class="row">
                <div class="col-lg-8">
                    <!-- Products Grid -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-shopping-bag"></i>
                                Productos Destacados
                            </h3>
                        </div>
                        <div class="products-grid">
                            <div class="product-item">
                                <img src="https://picsum.photos/seed/protein/200/120.jpg" alt="Proteína" class="product-image">
                                <div class="product-name">Proteína Whey</div>
                                <div class="product-price">$450</div>
                                <button class="btn-buy">Comprar</button>
                            </div>
                            <div class="product-item">
                                <img src="https://picsum.photos/seed/creatina/200/120.jpg" alt="Creatina" class="product-image">
                                <div class="product-name">Creatina Monohidrato</div>
                                <div class="product-price">$320</div>
                                <button class="btn-buy">Comprar</button>
                            </div>
                            <div class="product-item">
                                <img src="https://picsum.photos/seed/bcaa/200/120.jpg" alt="BCAA" class="product-image">
                                <div class="product-name">BCAA 4:1:1</div>
                                <div class="product-price">$280</div>
                                <button class="btn-buy">Comprar</button>
                            </div>
                            <div class="product-item">
                                <img src="https://picsum.photos/seed/preworkout/200/120.jpg" alt="Pre-entreno" class="product-image">
                                <div class="product-name">Pre-Entreno</div>
                                <div class="product-price">$380</div>
                                <button class="btn-buy">Comprar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Promo Banner -->
                    <div class="promo-banner">
                        <div class="promo-content">
                            <h4 class="promo-title">
                                <i class="fas fa-fire me-2"></i>Oferta Especial
                            </h4>
                            <p class="promo-description">¡20% de descuento en todos los suplementos!</p>
                            <p class="promo-description">Solo hasta fin de mes</p>
                            <span class="promo-badge">Código: GYM20</span>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <!-- Cart Summary -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-shopping-cart"></i>
                                Tu Carrito
                            </h3>
                        </div>
                        <div class="text-center py-5">
                            <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Tu carrito está vacío</p>
                            <button class="btn btn-outline-light">Ver productos</button>
                        </div>
                    </div>

                    <!-- Store Info -->
                    <div class="card-custom">
                        <div class="card-header-custom">
                            <h3 class="card-title">
                                <i class="fas fa-info-circle"></i>
                                Información de Tienda
                            </h3>
                        </div>
                        <ul class="info-list">
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Horario</div>
                                    <div class="info-value">5:00 AM - 11:00 PM</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Entrega</div>
                                    <div class="info-value">Recoge en recepción</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Pago</div>
                                    <div class="info-value">Efectivo/Tarjeta</div>
                                </div>
                            </li>
                            <li class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="info-text">
                                    <div class="info-label">Contacto</div>
                                    <div class="info-value">Ext. 102</div>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Get Internet Access -->
                    <div class="access-section">
                        <button class="btn-access" onclick="grantAccess()">
                            <i class="fas fa-wifi"></i>
                            Obtener Acceso a Internet
                        </button>
                        <p class="access-hint">Completa tu rutina para acceso completo</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Access Granted Screen -->
    <div id="accessGranted" class="access-granted">
        <div class="success-icon">
            <i class="fas fa-check"></i>
        </div>
        <h2>¡Acceso Concedido!</h2>
        <p class="lead">Ahora tienes acceso a internet por 2 horas</p>
        <p class="text-muted">Disfruta de tu entrenamiento en {{company_name}} Gym Pro</p>
        <div class="mt-4">
            <button class="btn btn-primary" onclick="window.location.reload()">
                <i class="fas fa-redo me-2"></i>Volver al Portal
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Ocultar overlay de carga
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('loadingOverlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';
                }, 500);
            }, 1000);
        });

        // Funcionalidad de inicio de sesión
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Mostrar carga
            document.getElementById('loadingOverlay').style.display = 'flex';

            // Simular proceso de inicio de sesión
            setTimeout(() => {
                if (username && password) {
                    document.getElementById('userName').textContent = username;
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('mainContainer').style.display = 'block';
                    document.getElementById('loadingOverlay').style.display = 'none';
                } else {
                    document.getElementById('loadingOverlay').style.display = 'none';
                    showNotification('Por favor ingresa usuario y contraseña', 'error');
                }
            }, 1500);
        });

        // Cambio de pestañas
        function switchTab(tabName) {
            // Ocultar todas las pestañas
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remover clase activa de todos los botones
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Mostrar pestaña seleccionada
            document.getElementById(tabName + '-tab').classList.add('active');

            // Agregar clase activa al botón presionado
            event.target.classList.add('active');
        }

        // Sistema de completar ejercicios
        let completedExercises = 0;
        const totalExercises = 4;
        let workoutData = {
            exercises: {},
            startTime: null,
            totalSets: 0,
            totalReps: 0,
            calories: 0,
            workoutDuration: 0
        };

        // Cargar datos de entrenamiento guardados
        function loadWorkoutData() {
            const saved = localStorage.getItem('gymmProWorkout');
            if (saved) {
                workoutData = JSON.parse(saved);
                updateWorkoutStats();
                // Restaurar ejercicios completados
                Object.keys(workoutData.exercises).forEach(exerciseId => {
                    const exercise = workoutData.exercises[exerciseId];
                    if (exercise.completed) {
                        const button = document.querySelector(`[onclick*="${exerciseId}"]`);
                        if (button) {
                            const exerciseItem = button.closest('.exercise-item');
                            exerciseItem.classList.add('completed');
                            button.innerHTML = '<i class="fas fa-check me-1"></i>Completado';
                            button.disabled = true;
                            completedExercises++;
                        }
                    }
                });
                updateProgress();
            } else {
                workoutData.startTime = new Date().toISOString();
            }
        }

        function completeExercise(button, exerciseId) {
            // Inicializar datos del ejercicio si no existen
            if (!workoutData.exercises[exerciseId]) {
                workoutData.exercises[exerciseId] = {
                    sets: 0,
                    reps: 0,
                    weight: 0,
                    completed: false,
                    completedAt: null
                };
            }

            // Show set completion modal
            showSetModal(exerciseId, button);
        }

        function showSetModal(exerciseId, button) {
            const modal = document.createElement('div');
            modal.className = 'exercise-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h4>Registrar Set</h4>
                        <button onclick="closeModal()" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Repeticiones:</label>
                            <input type="number" id="reps-${exerciseId}" min="1" max="50" value="10">
                        </div>
                        <div class="form-group">
                            <label>Peso (kg):</label>
                            <input type="number" id="weight-${exerciseId}" min="0" max="300" step="0.5" value="20">
                        </div>
                        <div class="form-group">
                            <label>Dificultad:</label>
                            <select id="difficulty-${exerciseId}">
                                <option value="easy">Fácil</option>
                                <option value="medium" selected>Medio</option>
                                <option value="hard">Difícil</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button onclick="closeModal()" class="btn-secondary">Cancelar</button>
                        <button onclick="recordSet('${exerciseId}', this)" class="btn-primary">Registrar Set</button>
                        <button onclick="finishExercise('${exerciseId}', this)" class="btn-success">Finalizar Ejercicio</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function recordSet(exerciseId, button) {
            const reps = parseInt(document.getElementById(`reps-${exerciseId}`).value);
            const weight = parseFloat(document.getElementById(`weight-${exerciseId}`).value);
            const difficulty = document.getElementById(`difficulty-${exerciseId}`).value;

            if (!workoutData.exercises[exerciseId]) {
                workoutData.exercises[exerciseId] = { sets: 0, reps: 0, weight: 0, completed: false };
            }

            // Record the set
            workoutData.exercises[exerciseId].sets++;
            workoutData.exercises[exerciseId].reps += reps;
            workoutData.exercises[exerciseId].weight = weight;
            workoutData.totalSets++;
            workoutData.totalReps += reps;

            // Calculate calories (basic estimation)
            const caloriesPerRep = difficulty === 'hard' ? 1.5 : difficulty === 'medium' ? 1 : 0.7;
            workoutData.calories += reps * caloriesPerRep;

            saveWorkoutData();
            updateWorkoutStats();

            showNotification(`Set registrado: ${reps} reps x ${weight}kg`, 'success');

            // Start rest timer
            startRestTimer();

            closeModal();
        }

        function finishExercise(exerciseId, button) {
            recordSet(exerciseId, button);

            // Mark exercise as completed
            workoutData.exercises[exerciseId].completed = true;
            workoutData.exercises[exerciseId].completedAt = new Date().toISOString();

            const exerciseButton = document.querySelector(`[onclick*="${exerciseId}"]`);
            const exerciseItem = exerciseButton.closest('.exercise-item');
            exerciseItem.classList.add('completed');

            exerciseButton.innerHTML = '<i class="fas fa-check me-1"></i>Completado';
            exerciseButton.disabled = true;

            completedExercises++;
            updateProgress();
            saveWorkoutData();

            showNotification('¡Ejercicio completado!', 'success');
            closeModal();
        }

        function closeModal() {
            const modal = document.querySelector('.exercise-modal');
            if (modal) modal.remove();
        }

        function startRestTimer() {
            let restTime = 60; // 60 seconds rest
            const notification = document.createElement('div');
            notification.className = 'rest-timer-notification';
            notification.innerHTML = `
                <div class="rest-content">
                    <i class="fas fa-clock"></i>
                    <span>Descanso: <span id="restCountdown">${restTime}</span>s</span>
                    <button onclick="skipRest()" class="skip-btn">Saltar</button>
                </div>
            `;
            document.body.appendChild(notification);

            const countdown = setInterval(() => {
                restTime--;
                const countdownEl = document.getElementById('restCountdown');
                if (countdownEl) countdownEl.textContent = restTime;

                if (restTime <= 0) {
                    clearInterval(countdown);
                    notification.remove();
                    showNotification('¡Tiempo de descanso terminado!', 'info');
                }
            }, 1000);

            // Remove after 60 seconds
            setTimeout(() => {
                if (notification.parentNode) notification.remove();
            }, 60000);
        }

        function skipRest() {
            const notification = document.querySelector('.rest-timer-notification');
            if (notification) notification.remove();
        }

        function updateProgress() {
            const progress = (completedExercises / totalExercises) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '%';

            // Check if all exercises are completed
            if (completedExercises === totalExercises) {
                showNotification('¡Felicidades! Has completado tu rutina', 'success');
                calculateWorkoutSummary();
            }
        }

        // Advanced Statistics System
        let userStats = {
            totalWorkouts: 0,
            totalTime: 0, // in minutes
            totalSets: 0,
            totalReps: 0,
            totalCalories: 0,
            personalRecords: {},
            streakDays: 0,
            lastWorkoutDate: null,
            weeklyGoal: 5, // workouts per week
            weeklyProgress: 0,
            monthlyStats: {},
            achievementsUnlocked: []
        };

        // Achievements system
        const achievements = {
            firstWorkout: { name: "Primer Paso", description: "Completar primer entrenamiento", icon: "🎯" },
            streak3: { name: "Constancia", description: "3 días consecutivos", icon: "🔥" },
            streak7: { name: "Semana Completa", description: "7 días consecutivos", icon: "🏆" },
            reps100: { name: "Centurión", description: "100 repeticiones en una sesión", icon: "💪" },
            time60: { name: "Guerrero", description: "60 minutos de entrenamiento", icon: "⏰" },
            calories500: { name: "Quemador", description: "500 calorías en una sesión", icon: "🔥" },
            pr_bench: { name: "Banco Personal", description: "Nuevo récord en press banca", icon: "🏋️" },
            pr_squat: { name: "Sentadilla Suprema", description: "Nuevo récord en sentadillas", icon: "🏋️‍♀️" }
        };

        function loadUserStats() {
            const saved = localStorage.getItem('gymProUserStats');
            if (saved) {
                userStats = { ...userStats, ...JSON.parse(saved) };
            }
            updateStatsDisplay();
        }

        function saveUserStats() {
            localStorage.setItem('gymProUserStats', JSON.stringify(userStats));
        }

        function updateWorkoutStats() {
            // Update real-time stats in dashboard
            const statsElements = {
                totalSets: document.querySelector('[data-stat="sets"]'),
                totalReps: document.querySelector('[data-stat="reps"]'),
                calories: document.querySelector('[data-stat="calories"]'),
                duration: document.querySelector('[data-stat="duration"]')
            };

            if (statsElements.totalSets) statsElements.totalSets.textContent = workoutData.totalSets;
            if (statsElements.totalReps) statsElements.totalReps.textContent = workoutData.totalReps;
            if (statsElements.calories) statsElements.calories.textContent = Math.round(workoutData.calories);

            // Calculate duration
            if (workoutData.startTime) {
                const duration = Math.round((new Date() - new Date(workoutData.startTime)) / 1000 / 60);
                if (statsElements.duration) statsElements.duration.textContent = duration + ' min';
            }

            // Update progress bars and stats
            updateProgressBars();
        }

        function updateStatsDisplay() {
            // Update overall stats in the UI
            updateProgressBars();
            updatePersonalRecords();
            updateAchievements();
            updateWeeklyProgress();
        }

        function updateProgressBars() {
            // Weekly goal progress
            const weeklyProgress = Math.min((userStats.weeklyProgress / userStats.weeklyGoal) * 100, 100);
            const weeklyProgressBar = document.querySelector('.weekly-progress-fill');
            const weeklyProgressText = document.querySelector('.weekly-progress-text');

            if (weeklyProgressBar) {
                weeklyProgressBar.style.width = weeklyProgress + '%';
            }
            if (weeklyProgressText) {
                weeklyProgressText.textContent = `${userStats.weeklyProgress}/${userStats.weeklyGoal} entrenamientos`;
            }

            // Daily calories goal (example: 300 calories per day)
            const dailyCaloriesGoal = 300;
            const caloriesProgress = Math.min((workoutData.calories / dailyCaloriesGoal) * 100, 100);
            const caloriesProgressBar = document.querySelector('.calories-progress-fill');

            if (caloriesProgressBar) {
                caloriesProgressBar.style.width = caloriesProgress + '%';
            }

            // Update streak display
            updateStreakDisplay();
        }

        function updatePersonalRecords() {
            const recordsContainer = document.querySelector('.records-grid');
            if (recordsContainer && Object.keys(userStats.personalRecords).length > 0) {
                recordsContainer.innerHTML = '';
                Object.entries(userStats.personalRecords).forEach(([exercise, record]) => {
                    const recordElement = document.createElement('div');
                    recordElement.className = 'record-item';
                    recordElement.innerHTML = `
                        <div class="record-exercise">${exercise}</div>
                        <div class="record-value">${record.weight}kg x ${record.reps}</div>
                        <div class="record-date">${new Date(record.date).toLocaleDateString()}</div>
                    `;
                    recordsContainer.appendChild(recordElement);
                });
            }
        }

        function updateStreakDisplay() {
            const streakElement = document.querySelector('.streak-counter');
            if (streakElement) {
                streakElement.innerHTML = `
                    <div class="streak-number">${userStats.streakDays}</div>
                    <div class="streak-label">Días seguidos</div>
                    <div class="streak-fire">${userStats.streakDays > 0 ? '🔥' : '💤'}</div>
                `;
            }
        }

        function updateAchievements() {
            const achievementsContainer = document.querySelector('.achievements-list');
            if (achievementsContainer) {
                const unlockedAchievements = userStats.achievementsUnlocked;
                achievementsContainer.innerHTML = '';

                Object.entries(achievements).forEach(([key, achievement]) => {
                    const isUnlocked = unlockedAchievements.includes(key);
                    const achievementElement = document.createElement('div');
                    achievementElement.className = `achievement-item ${isUnlocked ? 'unlocked' : 'locked'}`;
                    achievementElement.innerHTML = `
                        <div class="achievement-icon">${achievement.icon}</div>
                        <div class="achievement-info">
                            <div class="achievement-name">${achievement.name}</div>
                            <div class="achievement-description">${achievement.description}</div>
                        </div>
                        ${isUnlocked ? '<div class="achievement-unlocked">✅</div>' : ''}
                    `;
                    achievementsContainer.appendChild(achievementElement);
                });
            }
        }

        function updateWeeklyProgress() {
            const today = new Date();
            const startOfWeek = new Date(today.setDate(today.getDate() - today.getDay()));
            const history = JSON.parse(localStorage.getItem('gymProHistory') || '[]');

            const weekWorkouts = history.filter(workout => {
                const workoutDate = new Date(workout.date);
                return workoutDate >= startOfWeek;
            });

            userStats.weeklyProgress = weekWorkouts.length;
            saveUserStats();
        }

        function checkAchievements() {
            const newAchievements = [];

            // First workout
            if (userStats.totalWorkouts >= 1 && !userStats.achievementsUnlocked.includes('firstWorkout')) {
                newAchievements.push('firstWorkout');
            }

            // Streak achievements
            if (userStats.streakDays >= 3 && !userStats.achievementsUnlocked.includes('streak3')) {
                newAchievements.push('streak3');
            }
            if (userStats.streakDays >= 7 && !userStats.achievementsUnlocked.includes('streak7')) {
                newAchievements.push('streak7');
            }

            // Session achievements
            if (workoutData.totalReps >= 100 && !userStats.achievementsUnlocked.includes('reps100')) {
                newAchievements.push('reps100');
            }
            if (workoutData.workoutDuration >= 60 && !userStats.achievementsUnlocked.includes('time60')) {
                newAchievements.push('time60');
            }
            if (workoutData.calories >= 500 && !userStats.achievementsUnlocked.includes('calories500')) {
                newAchievements.push('calories500');
            }

            // Unlock and show new achievements
            newAchievements.forEach(achievementKey => {
                userStats.achievementsUnlocked.push(achievementKey);
                showAchievementUnlocked(achievements[achievementKey]);
            });

            if (newAchievements.length > 0) {
                saveUserStats();
                updateAchievements();
            }
        }

        function showAchievementUnlocked(achievement) {
            const achievementNotification = document.createElement('div');
            achievementNotification.className = 'achievement-notification';
            achievementNotification.innerHTML = `
                <div class="achievement-popup">
                    <div class="achievement-header">🏆 ¡Logro Desbloqueado!</div>
                    <div class="achievement-content">
                        <div class="achievement-icon-large">${achievement.icon}</div>
                        <div class="achievement-details">
                            <div class="achievement-name-large">${achievement.name}</div>
                            <div class="achievement-description-large">${achievement.description}</div>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(achievementNotification);

            // Auto remove after 5 seconds
            setTimeout(() => {
                achievementNotification.remove();
            }, 5000);
        }

        function updatePersonalRecord(exercise, weight, reps) {
            const exerciseKey = exercise.toLowerCase().replace(/\s+/g, '_');
            const currentRecord = userStats.personalRecords[exerciseKey];

            // Calculate one-rep max for comparison
            const oneRepMax = weight * (1 + reps / 30);

            if (!currentRecord || oneRepMax > (currentRecord.weight * (1 + currentRecord.reps / 30))) {
                userStats.personalRecords[exerciseKey] = {
                    weight: weight,
                    reps: reps,
                    date: new Date().toISOString(),
                    exercise: exercise
                };

                saveUserStats();
                updatePersonalRecords();
                showNotification(`🏆 ¡Nuevo récord personal en ${exercise}!`, 'success');

                // Check for PR achievements
                if (exerciseKey.includes('bench') || exerciseKey.includes('press')) {
                    if (!userStats.achievementsUnlocked.includes('pr_bench')) {
                        userStats.achievementsUnlocked.push('pr_bench');
                        showAchievementUnlocked(achievements.pr_bench);
                    }
                }
                if (exerciseKey.includes('squat') || exerciseKey.includes('sentadilla')) {
                    if (!userStats.achievementsUnlocked.includes('pr_squat')) {
                        userStats.achievementsUnlocked.push('pr_squat');
                        showAchievementUnlocked(achievements.pr_squat);
                    }
                }
            }
        }

        function updateStreakCounter() {
            const today = new Date().toDateString();
            const lastWorkout = userStats.lastWorkoutDate;

            if (!lastWorkout) {
                // First workout ever
                userStats.streakDays = 1;
            } else {
                const lastWorkoutDate = new Date(lastWorkout).toDateString();
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayString = yesterday.toDateString();

                if (lastWorkoutDate === today) {
                    // Already worked out today, don't change streak
                    return;
                } else if (lastWorkoutDate === yesterdayString) {
                    // Continued streak
                    userStats.streakDays++;
                } else {
                    // Streak broken, start over
                    userStats.streakDays = 1;
                }
            }

            userStats.lastWorkoutDate = new Date().toISOString();
            checkAchievements();
        }

        function calculateWorkoutSummary() {
            workoutData.workoutDuration = Math.round((new Date() - new Date(workoutData.startTime)) / 1000 / 60);

            // Update user stats
            userStats.totalWorkouts++;
            userStats.totalTime += workoutData.workoutDuration;
            userStats.totalSets += workoutData.totalSets;
            userStats.totalReps += workoutData.totalReps;
            userStats.totalCalories += workoutData.calories;

            // Update streak
            updateStreakCounter();

            // Check for personal records
            Object.values(workoutData.exercises).forEach(exercise => {
                if (exercise.weight && exercise.reps && exercise.completed) {
                    updatePersonalRecord(`Ejercicio ${Object.keys(workoutData.exercises).indexOf(exercise) + 1}`, exercise.weight, exercise.reps);
                }
            });

            // Check achievements
            checkAchievements();

            // Save stats
            saveUserStats();

            const summary = `
                <div class="workout-summary">
                    <h3>¡Entrenamiento Completado!</h3>
                    <div class="summary-stats">
                        <div class="stat"><strong>${workoutData.totalSets}</strong> Sets</div>
                        <div class="stat"><strong>${workoutData.totalReps}</strong> Repeticiones</div>
                        <div class="stat"><strong>${Math.round(workoutData.calories)}</strong> Calorías</div>
                        <div class="stat"><strong>${workoutData.workoutDuration}</strong> Minutos</div>
                    </div>
                    <div class="achievement-summary">
                        <div class="streak-info">🔥 Racha: ${userStats.streakDays} días</div>
                        <div class="total-workouts">🏋️ Total: ${userStats.totalWorkouts} entrenamientos</div>
                    </div>
                </div>
            `;

            showNotification(summary, 'success');

            // Save to workout history
            saveWorkoutToHistory();

            // Update display
            updateStatsDisplay();
        }

        function saveWorkoutData() {
            localStorage.setItem('gymProWorkout', JSON.stringify(workoutData));
        }

        function saveWorkoutToHistory() {
            const history = JSON.parse(localStorage.getItem('gymProHistory') || '[]');
            history.push({
                date: new Date().toISOString(),
                ...workoutData
            });
            localStorage.setItem('gymProHistory', JSON.stringify(history));

            // Clear current workout
            localStorage.removeItem('gymProWorkout');
        }

        // Advanced Timer functionality
        let timerInterval;
        let seconds = 0;
        let isRunning = false;
        let lapTimes = [];
        let countdownInterval;
        let countdownSeconds = 0;

        // Workout Timer Functions
        function startTimer() {
            if (!timerInterval) {
                isRunning = true;
                timerInterval = setInterval(() => {
                    seconds++;
                    updateTimerDisplay();
                    saveTimerState();
                }, 1000);
                updateTimerButtons();
            }
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            isRunning = false;
            updateTimerButtons();
            saveTimerState();
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            isRunning = false;
            seconds = 0;
            lapTimes = [];
            updateTimerDisplay();
            updateTimerButtons();
            clearLapTimes();
            saveTimerState();
        }

        function lapTimer() {
            if (isRunning) {
                const lapTime = seconds;
                lapTimes.push(lapTime);
                addLapTime(lapTime, lapTimes.length);
                showNotification(`Vuelta ${lapTimes.length}: ${formatTime(lapTime)}`, 'info');
            }
        }

        function updateTimerDisplay() {
            const timerElement = document.getElementById('timer');
            if (timerElement) {
                timerElement.textContent = formatTime(seconds);
            }
        }

        function updateTimerButtons() {
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const resetBtn = document.getElementById('resetBtn');
            const lapBtn = document.getElementById('lapBtn');

            if (startBtn && pauseBtn && resetBtn && lapBtn) {
                if (isRunning) {
                    startBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                    lapBtn.disabled = false;
                } else {
                    startBtn.style.display = 'inline-block';
                    pauseBtn.style.display = 'none';
                    lapBtn.disabled = true;
                }
                resetBtn.disabled = seconds === 0;
            }
        }

        function addLapTime(lapTime, lapNumber) {
            const lapContainer = document.getElementById('lapTimes');
            if (lapContainer) {
                const lapElement = document.createElement('div');
                lapElement.className = 'lap-time';
                lapElement.innerHTML = `
                    <span class="lap-number">Vuelta ${lapNumber}</span>
                    <span class="lap-duration">${formatTime(lapTime)}</span>
                `;
                lapContainer.appendChild(lapElement);
                lapContainer.scrollTop = lapContainer.scrollHeight;
            }
        }

        function clearLapTimes() {
            const lapContainer = document.getElementById('lapTimes');
            if (lapContainer) {
                lapContainer.innerHTML = '';
            }
        }

        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const secs = totalSeconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // Countdown Timer Functions
        function startCountdown() {
            const input = document.getElementById('countdownInput');
            if (input) {
                const minutes = parseInt(input.value) || 5;
                countdownSeconds = minutes * 60;
                updateCountdownDisplay();

                countdownInterval = setInterval(() => {
                    countdownSeconds--;
                    updateCountdownDisplay();

                    if (countdownSeconds <= 0) {
                        clearInterval(countdownInterval);
                        countdownInterval = null;
                        showNotification('¡Tiempo terminado!', 'warning');
                        playNotificationSound();
                    } else if (countdownSeconds <= 10) {
                        showNotification(`${countdownSeconds}s restantes`, 'warning');
                    }
                }, 1000);

                updateCountdownButtons();
            }
        }

        function pauseCountdown() {
            clearInterval(countdownInterval);
            countdownInterval = null;
            updateCountdownButtons();
        }

        function resetCountdown() {
            clearInterval(countdownInterval);
            countdownInterval = null;
            countdownSeconds = 0;
            updateCountdownDisplay();
            updateCountdownButtons();
        }

        function updateCountdownDisplay() {
            const countdownElement = document.getElementById('countdown');
            if (countdownElement) {
                countdownElement.textContent = formatTime(countdownSeconds);
            }
        }

        function updateCountdownButtons() {
            const startBtn = document.getElementById('countdownStartBtn');
            const pauseBtn = document.getElementById('countdownPauseBtn');
            const resetBtn = document.getElementById('countdownResetBtn');

            if (startBtn && pauseBtn && resetBtn) {
                if (countdownInterval) {
                    startBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                } else {
                    startBtn.style.display = 'inline-block';
                    pauseBtn.style.display = 'none';
                }
                resetBtn.disabled = countdownSeconds === 0;
            }
        }

        // Exercise Timer Presets
        function startExerciseTimer(exerciseType) {
            let duration;
            switch (exerciseType) {
                case 'cardio':
                    duration = 30 * 60; // 30 minutes
                    break;
                case 'strength':
                    duration = 45 * 60; // 45 minutes
                    break;
                case 'hiit':
                    duration = 20 * 60; // 20 minutes
                    break;
                case 'rest':
                    duration = 2 * 60; // 2 minutes
                    break;
                default:
                    duration = 30 * 60;
            }

            countdownSeconds = duration;
            updateCountdownDisplay();
            startCountdown();
            showNotification(`Timer iniciado para ${exerciseType}: ${Math.floor(duration/60)} minutos`, 'info');
        }

        // Timer State Persistence
        function saveTimerState() {
            const timerState = {
                seconds: seconds,
                isRunning: isRunning,
                lapTimes: lapTimes,
                lastUpdate: new Date().toISOString()
            };
            localStorage.setItem('gymProTimer', JSON.stringify(timerState));
        }

        function loadTimerState() {
            const saved = localStorage.getItem('gymProTimer');
            if (saved) {
                const timerState = JSON.parse(saved);
                seconds = timerState.seconds || 0;
                lapTimes = timerState.lapTimes || [];

                // Restore lap times
                lapTimes.forEach((lapTime, index) => {
                    addLapTime(lapTime, index + 1);
                });

                // If timer was running, calculate elapsed time
                if (timerState.isRunning && timerState.lastUpdate) {
                    const elapsed = Math.floor((new Date() - new Date(timerState.lastUpdate)) / 1000);
                    seconds += elapsed;
                    startTimer();
                }

                updateTimerDisplay();
                updateTimerButtons();
            }
        }

        // Notification Sound
        function playNotificationSound() {
            // Create audio context for timer completion sound
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.2);
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.4);

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.6);
            } catch (error) {
                console.log('Audio not supported');
            }
        }

        // Advanced Music integration
        let currentPlaylist = null;
        let isPlaying = false;
        let currentTrack = 0;

        const workoutPlaylists = {
            cardio: {
                name: "Cardio Burn",
                tracks: [
                    { title: "Blinding Lights", artist: "The Weeknd", duration: "3:20" },
                    { title: "Uptown Funk", artist: "Mark Ronson ft. Bruno Mars", duration: "4:30" },
                    { title: "Can't Stop the Feeling", artist: "Justin Timberlake", duration: "3:56" },
                    { title: "Levitating", artist: "Dua Lipa", duration: "3:23" },
                    { title: "Good 4 U", artist: "Olivia Rodrigo", duration: "2:58" }
                ],
                bpm: 120
            },
            strength: {
                name: "Beast Mode",
                tracks: [
                    { title: "Till I Collapse", artist: "Eminem", duration: "4:57" },
                    { title: "Eye of the Tiger", artist: "Survivor", duration: "4:05" },
                    { title: "Thunderstruck", artist: "AC/DC", duration: "4:52" },
                    { title: "We Will Rock You", artist: "Queen", duration: "2:02" },
                    { title: "Stronger", artist: "Kanye West", duration: "5:11" }
                ],
                bpm: 130
            },
            yoga: {
                name: "Zen Flow",
                tracks: [
                    { title: "Weightless", artist: "Marconi Union", duration: "8:10" },
                    { title: "Clair de Lune", artist: "Claude Debussy", duration: "5:12" },
                    { title: "Spa Music", artist: "Nature Sounds", duration: "6:30" },
                    { title: "Om Meditation", artist: "Tibetan Monks", duration: "10:00" },
                    { title: "River Flows", artist: "Ambient Nature", duration: "7:45" }
                ],
                bpm: 60
            }
        };

        // Integración de Reproductores de Música Nativos con APIs Reales
        // CONFIGURACIÓN OBLIGATORIA: Estas credenciales deben obtenerse y configurarse:
        // 1. Spotify: https://developer.spotify.com/dashboard - Crear app y obtener Client ID/Secret
        // 2. Google/YouTube: https://console.developers.google.com/ - Habilitar YouTube Data API v3
        // 3. Apple Music: https://developer.apple.com/music/ - Obtener MusicKit Token
        // 4. Facebook: https://developers.facebook.com/apps/ - Para login social opcional

        const spotifyClientId = 'TU_SPOTIFY_CLIENT_ID'; // Reemplazar con tu Client ID real
        const googleClientId = 'TU_GOOGLE_CLIENT_ID'; // Reemplazar con tu Client ID real
        const facebookAppId = 'TU_FACEBOOK_APP_ID'; // Reemplazar con tu App ID real
        const redirectUri = window.location.origin + '/auth/callback';

        let currentMusicService = null;
        let musicAuth = {
            spotify: { connected: false, token: null },
            appleMusic: { connected: false, token: null },
            youtubeMusic: { connected: false, token: null }
        };

        function openSpotify() {
            if (!musicAuth.spotify.connected) {
                showMusicLoginModal('spotify');
            } else {
                switchMusicService('spotify');
                showNotification('Conectado a Spotify', 'success');
            }
        }

        function openAppleMusic() {
            if (!musicAuth.appleMusic.connected) {
                showMusicLoginModal('appleMusic');
            } else {
                switchMusicService('appleMusic');
                showNotification('Conectado a Apple Music', 'success');
            }
        }

        function openYouTubeMusic() {
            if (!musicAuth.youtubeMusic.connected) {
                showMusicLoginModal('youtubeMusic');
            } else {
                switchMusicService('youtubeMusic');
                showNotification('Conectado a YouTube Music', 'success');
            }
        }

        function showMusicLoginModal(service) {
            const serviceNames = {
                spotify: 'Spotify',
                appleMusic: 'Apple Music',
                youtubeMusic: 'YouTube Music'
            };

            const serviceConfigs = {
                spotify: {
                    name: 'Spotify',
                    color: '#1DB954',
                    logo: '♪',
                    description: 'Escucha millones de canciones y podcasts',
                    socialOptions: [
                        { provider: 'google', icon: '📧', text: 'Continuar con Google' },
                        { provider: 'facebook', icon: '📘', text: 'Continuar con Facebook' },
                        { provider: 'apple', icon: '🍎', text: 'Continuar con Apple' }
                    ]
                },
                appleMusic: {
                    name: 'Apple Music',
                    color: '#FC3C44',
                    logo: '🍎',
                    description: 'Más de 100 millones de canciones sin anuncios',
                    socialOptions: [
                        { provider: 'apple', icon: '🍎', text: 'Continuar con Apple ID' },
                        { provider: 'google', icon: '📧', text: 'Continuar con Google' },
                        { provider: 'facebook', icon: '📘', text: 'Continuar con Facebook' }
                    ]
                },
                youtubeMusic: {
                    name: 'YouTube Music',
                    color: '#FF0000',
                    logo: '📺',
                    description: 'Tu música y videos musicales favoritos',
                    socialOptions: [
                        { provider: 'google', icon: '📧', text: 'Continuar con Google' },
                        { provider: 'youtube', icon: '📺', text: 'Usar cuenta de YouTube' },
                        { provider: 'gmail', icon: '✉️', text: 'Continuar con Gmail' }
                    ]
                }
            };

            const config = serviceConfigs[service];
            const modal = document.createElement('div');
            modal.className = 'music-login-modal';
            modal.innerHTML = `
                <div class="modal-content-music">
                    <div class="modal-header-music" style="background: linear-gradient(135deg, ${config.color}, ${config.color}dd)">
                        <div class="service-header">
                            <div class="service-logo-large">${config.logo}</div>
                            <div>
                                <h4>${config.name}</h4>
                                <p class="service-description">${config.description}</p>
                            </div>
                        </div>
                        <button onclick="closeMusicModal()" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body-music">
                        <div class="manual-login">
                            <div class="login-form-music">
                                <input type="email" id="music-email-${service}" placeholder="Correo electrónico" class="music-input">
                                <input type="password" id="music-password-${service}" placeholder="Contraseña" class="music-input">
                            </div>
                            <div class="login-options">
                                <label class="remember-me">
                                    <input type="checkbox" id="remember-${service}">
                                    <span>Recordarme</span>
                                </label>
                                <a href="#" class="forgot-password">¿Olvidaste tu contraseña?</a>
                            </div>
                        </div>

                        <div class="divider">
                            <span>o continúa con</span>
                        </div>

                        <div class="social-auth-grid">
                            ${config.socialOptions.map(option => `
                                <button class="social-btn-compact" onclick="authenticateWithProvider('${service}', '${option.provider}')" title="${option.text}">
                                    <span class="social-icon-compact">${option.icon}</span>
                                </button>
                            `).join('')}
                        </div>

                        <div class="auth-info">
                            <p><strong>🔐 Seguro:</strong> Conexión directa con ${config.name}</p>
                        </div>
                    </div>
                    <div class="modal-footer-music">
                        <button onclick="closeMusicModal()" class="btn-secondary">Cancelar</button>
                        <button onclick="connectMusicService('${service}')" class="btn-primary">Iniciar Sesión</button>
                        <button onclick="showSignupOptions('${service}')" class="btn-outline">Crear Cuenta</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function authenticateWithProvider(service, provider) {
            showNotification(`Conectando con ${provider}...`, 'info');

            // Configuración de URLs para OAuth real
            const authUrls = {
                spotify: {
                    google: 'https://accounts.spotify.com/authorize?client_id=' + spotifyClientId + '&response_type=code&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state',
                    facebook: 'https://www.facebook.com/v18.0/dialog/oauth?client_id=DEMO_FB_APP_ID&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=email',
                    apple: 'https://accounts.spotify.com/authorize?client_id=' + spotifyClientId + '&response_type=code&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=streaming%20user-read-email%20user-read-private'
                },
                appleMusic: {
                    apple: 'https://js-cdn.music.apple.com/musickit/v3/musickit.js',
                    google: 'https://accounts.google.com/o/oauth2/v2/auth?client_id=' + googleClientId + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=https://www.googleapis.com/auth/userinfo.email&response_type=code',
                    facebook: 'https://www.facebook.com/v18.0/dialog/oauth?client_id=' + facebookAppId + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=email'
                },
                youtubeMusic: {
                    google: 'https://accounts.google.com/o/oauth2/v2/auth?client_id=' + googleClientId + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=https://www.googleapis.com/auth/youtube&response_type=code',
                    youtube: 'https://accounts.google.com/o/oauth2/v2/auth?client_id=' + googleClientId + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=https://www.googleapis.com/auth/youtube&response_type=code',
                    gmail: 'https://accounts.google.com/o/oauth2/v2/auth?client_id=' + googleClientId + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&scope=https://www.googleapis.com/auth/youtube&response_type=code'
                }
            };

            // Abrir ventana de autenticación OAuth real
            const authUrl = authUrls[service][provider];
            if (!authUrl) {
                showNotification('Método de autenticación no disponible', 'error');
                return;
            }

            // Abrir ventana popup para OAuth
            const authWindow = window.open(
                authUrl,
                'auth_popup',
                'width=500,height=600,scrollbars=yes,resizable=yes'
            );

            // Escuchar el mensaje de retorno de la autenticación
            const checkClosed = setInterval(() => {
                if (authWindow.closed) {
                    clearInterval(checkClosed);
                    // Verificar si se obtuvo autorización
                    handleAuthCallback(service, provider);
                }
            }, 1000);

            // Timeout para la autenticación
            setTimeout(() => {
                if (!authWindow.closed) {
                    authWindow.close();
                    showNotification('Tiempo de autenticación agotado', 'warning');
                }
            }, 300000); // 5 minutos
        }

        // Función para manejar el callback de autenticación OAuth
        function handleAuthCallback(service, provider) {
            // Verificar si hay un código de autorización en la URL
            const urlParams = new URLSearchParams(window.location.search);
            const authCode = urlParams.get('code');
            const error = urlParams.get('error');

            if (error) {
                showNotification('Error en la autenticación: ' + error, 'error');
                return;
            }

            if (authCode) {
                // Intercambiar código por token de acceso
                exchangeCodeForToken(service, provider, authCode);
            } else {
                showNotification('No se recibió autorización del usuario', 'warning');
            }
        }

        // Función para intercambiar código OAuth por token de acceso
        async function exchangeCodeForToken(service, provider, authCode) {
            try {
                showNotification('Obteniendo token de acceso...', 'info');

                let tokenEndpoint;
                let requestBody;
                let headers = {
                    'Content-Type': 'application/x-www-form-urlencoded'
                };

                switch (service) {
                    case 'spotify':
                        tokenEndpoint = 'https://accounts.spotify.com/api/token';
                        requestBody = new URLSearchParams({
                            grant_type: 'authorization_code',
                            code: authCode,
                            redirect_uri: redirectUri,
                            client_id: spotifyClientId,
                            client_secret: 'TU_SPOTIFY_CLIENT_SECRET' // Debe estar en el servidor
                        });
                        break;

                    case 'youtubeMusic':
                        tokenEndpoint = 'https://oauth2.googleapis.com/token';
                        requestBody = new URLSearchParams({
                            grant_type: 'authorization_code',
                            code: authCode,
                            redirect_uri: redirectUri,
                            client_id: googleClientId,
                            client_secret: 'TU_GOOGLE_CLIENT_SECRET' // Debe estar en el servidor
                        });
                        break;

                    case 'appleMusic':
                        // Apple Music usa MusicKit JS que maneja la autenticación diferente
                        await initializeAppleMusic();
                        return;
                }

                const response = await fetch(tokenEndpoint, {
                    method: 'POST',
                    headers: headers,
                    body: requestBody
                });

                if (response.ok) {
                    const tokenData = await response.json();

                    // Guardar token y establecer como conectado
                    musicAuth[service].connected = true;
                    musicAuth[service].token = tokenData.access_token;
                    musicAuth[service].refreshToken = tokenData.refresh_token;
                    musicAuth[service].provider = provider;
                    musicAuth[service].expiresAt = Date.now() + (tokenData.expires_in * 1000);

                    localStorage.setItem('gymProMusicAuth', JSON.stringify(musicAuth));

                    closeMusicModal();
                    switchMusicService(service);
                    showMusicPlayer(service);
                    showNotification(`¡Conectado exitosamente a ${service}!`, 'success');

                    // Cargar playlists reales del servicio
                    await loadRealServicePlaylists(service);
                } else {
                    throw new Error('Error al obtener token de acceso');
                }
            } catch (error) {
                console.error('Error en autenticación:', error);
                showNotification('Error al conectar con el servicio', 'error');
            }
        }

        // Inicializar Apple Music usando MusicKit JS
        async function initializeAppleMusic() {
            try {
                await MusicKit.configure({
                    developerToken: 'TU_APPLE_MUSIC_DEVELOPER_TOKEN', // Obtener de Apple Developer
                    app: {
                        name: 'Gym Pro Portal',
                        build: '1.0.0'
                    }
                });

                const music = MusicKit.getInstance();
                await music.authorize();

                musicAuth.appleMusic.connected = true;
                musicAuth.appleMusic.token = music.musicUserToken;
                musicAuth.appleMusic.provider = 'apple';

                localStorage.setItem('gymProMusicAuth', JSON.stringify(musicAuth));

                closeMusicModal();
                switchMusicService('appleMusic');
                showMusicPlayer('appleMusic');
                showNotification('¡Conectado exitosamente a Apple Music!', 'success');

                await loadRealServicePlaylists('appleMusic');
            } catch (error) {
                console.error('Error al inicializar Apple Music:', error);
                showNotification('Error al conectar con Apple Music', 'error');
            }
        }

        function showSignupOptions(service) {
            showNotification('Redirigiendo a registro...', 'info');
            // In real implementation, this would show signup flow
            setTimeout(() => {
                authenticateWithProvider(service, 'email');
            }, 1000);
        }

        function getServiceIcon(service) {
            const icons = {
                spotify: `<div class="spotify-icon">♪</div>`,
                appleMusic: `<div class="apple-music-icon">🍎</div>`,
                youtubeMusic: `<div class="youtube-music-icon">📺</div>`
            };
            return icons[service] || '🎵';
        }

        // Función para conectar con credenciales manuales (inicio de sesión directo)
        async function connectMusicService(service) {
            const email = document.getElementById(`music-email-${service}`).value;
            const password = document.getElementById(`music-password-${service}`).value;

            if (!email || !password) {
                showNotification('Por favor ingresa email y contraseña', 'warning');
                return;
            }

            showNotification('Conectando...', 'info');

            try {
                // Nota: La autenticación directa con usuario/contraseña no es recomendada ni soportada
                // por la mayoría de servicios de música por razones de seguridad.
                // La mayoría requieren OAuth 2.0 con tokens de acceso.

                showNotification('Redirigiendo a autenticación segura...', 'info');

                // Redirigir a OAuth para autenticación segura
                switch (service) {
                    case 'spotify':
                        authenticateWithProvider(service, 'google');
                        break;
                    case 'appleMusic':
                        authenticateWithProvider(service, 'apple');
                        break;
                    case 'youtubeMusic':
                        authenticateWithProvider(service, 'google');
                        break;
                    default:
                        showNotification('Servicio no soportado', 'error');
                }
            } catch (error) {
                console.error('Error en autenticación manual:', error);
                showNotification('Error al conectar. Usa autenticación OAuth.', 'error');
            }
        }

        function switchMusicService(service) {
            currentMusicService = service;
            updateMusicServiceUI();
            updateMusicPlayer();
        }

        // Función para cargar playlists reales desde las APIs de los servicios
        async function loadRealServicePlaylists(service) {
            try {
                showNotification('Cargando playlists...', 'info');
                let playlists = [];

                switch (service) {
                    case 'spotify':
                        playlists = await getSpotifyPlaylists();
                        break;
                    case 'appleMusic':
                        playlists = await getAppleMusicPlaylists();
                        break;
                    case 'youtubeMusic':
                        playlists = await getYouTubeMusicPlaylists();
                        break;
                }

                updatePlaylistDisplay(playlists, service);
                showNotification('Playlists cargadas exitosamente', 'success');
            } catch (error) {
                console.error('Error cargando playlists:', error);
                showNotification('Error al cargar playlists', 'error');
                // Fallback a playlists predeterminadas
                loadFallbackPlaylists(service);
            }
        }

        // Obtener playlists reales de Spotify
        async function getSpotifyPlaylists() {
            const token = musicAuth.spotify.token;
            const response = await fetch('https://api.spotify.com/v1/browse/categories/workout/playlists?limit=10', {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });

            if (!response.ok) {
                throw new Error('Error al obtener playlists de Spotify');
            }

            const data = await response.json();
            return data.playlists.items.map(playlist => ({
                id: playlist.id,
                name: playlist.name,
                tracks: playlist.tracks.total,
                duration: 'Variable',
                image: playlist.images[0]?.url,
                external_url: playlist.external_urls.spotify
            }));
        }

        // Obtener playlists reales de Apple Music
        async function getAppleMusicPlaylists() {
            const music = MusicKit.getInstance();
            const searchResponse = await music.api.search('workout', {
                types: ['playlists'],
                limit: 10
            });

            return searchResponse.playlists.data.map(playlist => ({
                id: playlist.id,
                name: playlist.attributes.name,
                tracks: playlist.attributes.trackCount,
                duration: playlist.attributes.durationInMillis ?
                    Math.round(playlist.attributes.durationInMillis / 60000) + ' min' : 'Variable',
                image: playlist.attributes.artwork?.url?.replace('{w}', '300').replace('{h}', '300'),
                description: playlist.attributes.description?.standard
            }));
        }

        // Obtener playlists reales de YouTube Music
        async function getYouTubeMusicPlaylists() {
            const token = musicAuth.youtubeMusic.token;

            try {
                // Corregir la URL de la API - usar API key en lugar de Authorization header para búsquedas públicas
                const searchResponse = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=workout+music+gym&type=playlist&maxResults=10&key=AIzaSyDummyKeyForDemo&regionCode=US&relevanceLanguage=es`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                // Si falla la API real, usar datos de fallback inmediatamente
                if (!searchResponse.ok) {
                    console.log('API de YouTube no disponible, usando playlists de demostración');
                    throw new Error('YouTube API no configurada correctamente');
                }

                const data = await searchResponse.json();

                if (!data.items || data.items.length === 0) {
                    throw new Error('No se encontraron playlists');
                }

                // Procesar resultados reales
                return data.items.map((item, index) => ({
                    id: item.id.playlistId || `yt_demo_${index}`,
                    name: item.snippet.title || `Playlist ${index + 1}`,
                    tracks: Math.floor(Math.random() * 50) + 20, // Número aleatorio de tracks
                    duration: 'Variable',
                    image: item.snippet.thumbnails?.medium?.url || item.snippet.thumbnails?.default?.url,
                    channelTitle: item.snippet.channelTitle || 'Canal de Música'
                }));

            } catch (error) {
                console.error('Error con YouTube API:', error);
                // Inmediatamente usar fallback en lugar de fallar
                throw error;
            }
        }

        // Playlists de respaldo en caso de error con las APIs
        function loadFallbackPlaylists(service) {
            const fallbackPlaylists = {
                spotify: [
                    { id: 'fallback_1', name: 'Beast Mode Workout', tracks: 45, duration: '2h 30m' },
                    { id: 'fallback_2', name: 'Cardio Explosion', tracks: 38, duration: '2h 15m' },
                    { id: 'fallback_3', name: 'Pump Iron Heavy', tracks: 52, duration: '3h 10m' }
                ],
                appleMusic: [
                    { id: 'fallback_4', name: 'Workout Hits Radio', tracks: 42, duration: '2h 45m' },
                    { id: 'fallback_5', name: 'Energy Boost Mix', tracks: 35, duration: '2h 05m' },
                    { id: 'fallback_6', name: 'Strength Training Pro', tracks: 48, duration: '2h 55m' }
                ],
                youtubeMusic: [
                    { id: 'fallback_7', name: 'Gym Motivation Videos', tracks: 40, duration: '2h 20m' },
                    { id: 'fallback_8', name: 'Workout Bangers 2024', tracks: 55, duration: '3h 25m' },
                    { id: 'fallback_9', name: 'Fitness Flow Sessions', tracks: 33, duration: '1h 50m' }
                ]
            };

            updatePlaylistDisplay(fallbackPlaylists[service] || [], service);
        }

        function updatePlaylistDisplay(playlists, service) {
            const playlistContainer = document.querySelector('.service-playlists');
            if (playlistContainer) {
                playlistContainer.innerHTML = `
                    <h4>Playlists de ${service.charAt(0).toUpperCase() + service.slice(1)}</h4>
                    ${playlists.map(playlist => `
                        <div class="playlist-item" onclick="loadPlaylistToPlayer('${playlist.id}', '${playlist.name}', '${service}')">
                            <div class="playlist-info">
                                <div class="playlist-name">${playlist.name}</div>
                                <div class="playlist-details">${playlist.tracks} canciones • ${playlist.duration}</div>
                            </div>
                            <div class="playlist-play">▶️</div>
                        </div>
                    `).join('')}
                `;
            }
        }

        function loadPlaylistToPlayer(playlistId, playlistName, service) {
            // Simulate loading playlist into the player
            showNotification(`Cargando "${playlistName}" desde ${service}...`, 'info');

            // Update current playlist with service-specific data
            currentPlaylist = {
                name: playlistName,
                service: service,
                tracks: generateServiceTracks(service),
                bpm: 125
            };

            currentTrack = 0;
            isPlaying = true;
            updateMusicPlayer();
            startMusicTimer();

            showNotification(`♪ Reproduciendo: ${playlistName}`, 'success');
        }

        function generateServiceTracks(service) {
            const serviceTracks = {
                spotify: [
                    { title: "Don't Stop Me Now", artist: "Queen", duration: "3:29" },
                    { title: "Stronger", artist: "Kanye West", duration: "5:12" },
                    { title: "Till I Collapse", artist: "Eminem", duration: "4:57" },
                    { title: "Eye of the Tiger", artist: "Survivor", duration: "4:05" },
                    { title: "Thunderstruck", artist: "AC/DC", duration: "4:52" }
                ],
                appleMusic: [
                    { title: "Lose Yourself", artist: "Eminem", duration: "5:26" },
                    { title: "Pump It", artist: "Black Eyed Peas", duration: "3:35" },
                    { title: "Welcome to the Jungle", artist: "Guns N' Roses", duration: "4:31" },
                    { title: "We Will Rock You", artist: "Queen", duration: "2:02" },
                    { title: "Believer", artist: "Imagine Dragons", duration: "3:24" }
                ],
                youtubeMusic: [
                    { title: "Unstoppable", artist: "Sia", duration: "3:37" },
                    { title: "Titanium", artist: "David Guetta ft. Sia", duration: "4:05" },
                    { title: "Centuries", artist: "Fall Out Boy", duration: "3:46" },
                    { title: "Warriors", artist: "Imagine Dragons", duration: "2:50" },
                    { title: "Hall of Fame", artist: "The Script ft. will.i.am", duration: "3:23" }
                ]
            };

            return serviceTracks[service] || serviceTracks.spotify;
        }

        function updateMusicServiceUI() {
            const serviceIndicator = document.querySelector('.current-service');
            if (serviceIndicator) {
                const serviceNames = {
                    spotify: 'Spotify',
                    appleMusic: 'Apple Music',
                    youtubeMusic: 'YouTube Music'
                };

                serviceIndicator.innerHTML = `
                    <div class="service-badge ${currentMusicService}">
                        ${getServiceIcon(currentMusicService)}
                        <span>${serviceNames[currentMusicService]}</span>
                    </div>
                `;
            }
        }

        function closeMusicModal() {
            const modal = document.querySelector('.music-login-modal');
            if (modal) modal.remove();
        }

        function showMusicPlayer(service) {
            const musicWidget = document.querySelector('.music-widget');
            if (!musicWidget) return;

            const serviceConfigs = {
                spotify: {
                    name: 'Spotify',
                    color: '#1DB954',
                    logo: '♪',
                    interface: 'spotify-player'
                },
                appleMusic: {
                    name: 'Apple Music',
                    color: '#FC3C44',
                    logo: '🍎',
                    interface: 'apple-player'
                },
                youtubeMusic: {
                    name: 'YouTube Music',
                    color: '#FF0000',
                    logo: '📺',
                    interface: 'youtube-player'
                }
            };

            const config = serviceConfigs[service];

            musicWidget.innerHTML = `
                <div class="service-player ${config.interface}" style="border-top: 3px solid ${config.color}">
                    <div class="player-header" style="background: linear-gradient(135deg, ${config.color}20, ${config.color}10)">
                        <div class="service-info">
                            <span class="service-logo">${config.logo}</span>
                            <div class="service-details">
                                <h4>${config.name}</h4>
                                <p>Conectado como ${musicAuth[service].provider || 'usuario'}</p>
                            </div>
                        </div>
                        <button onclick="disconnectService('${service}')" class="disconnect-btn">✕</button>
                    </div>

                    <div class="player-content">
                        ${generatePlayerInterface(service, config)}
                    </div>
                </div>
            `;
        }

        function generatePlayerInterface(service, config) {
            if (service === 'spotify') {
                return `
                    <div class="spotify-interface">
                        <div class="now-playing">
                            <div class="album-art">♪</div>
                            <div class="track-info">
                                <div class="track-title">Eye of the Tiger</div>
                                <div class="track-artist">Survivor</div>
                                <div class="track-album">Eye of the Tiger</div>
                            </div>
                        </div>

                        <div class="player-controls">
                            <button class="control-btn">🔀</button>
                            <button class="control-btn">⏮️</button>
                            <button class="control-btn main-play" onclick="toggleSpotifyPlayback()">▶️</button>
                            <button class="control-btn">⏭️</button>
                            <button class="control-btn">🔁</button>
                        </div>

                        <div class="progress-bar">
                            <span class="time-current">1:23</span>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: 35%"></div>
                            </div>
                            <span class="time-total">4:05</span>
                        </div>

                        <div class="spotify-playlists">
                            <h5>Tus Playlists de Entreno</h5>
                            <div class="playlist-grid">
                                <div class="playlist-card" onclick="playSpotifyPlaylist('Beast Mode')">
                                    <div class="playlist-cover">💪</div>
                                    <div class="playlist-name">Beast Mode</div>
                                    <div class="playlist-tracks">45 canciones</div>
                                </div>
                                <div class="playlist-card" onclick="playSpotifyPlaylist('Cardio Mix')">
                                    <div class="playlist-cover">🏃</div>
                                    <div class="playlist-name">Cardio Mix</div>
                                    <div class="playlist-tracks">38 canciones</div>
                                </div>
                                <div class="playlist-card" onclick="playSpotifyPlaylist('Pump Iron')">
                                    <div class="playlist-cover">🏋️</div>
                                    <div class="playlist-name">Pump Iron</div>
                                    <div class="playlist-tracks">52 canciones</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (service === 'appleMusic') {
                return `
                    <div class="apple-interface">
                        <div class="apple-now-playing">
                            <div class="apple-album-art">🍎</div>
                            <div class="apple-track-info">
                                <div class="apple-track-title">Lose Yourself</div>
                                <div class="apple-track-artist">Eminem</div>
                                <div class="apple-track-album">8 Mile Soundtrack</div>
                            </div>
                        </div>

                        <div class="apple-controls">
                            <button class="apple-btn">⏮️</button>
                            <button class="apple-btn apple-play" onclick="toggleApplePlayback()">▶️</button>
                            <button class="apple-btn">⏭️</button>
                            <button class="apple-btn">❤️</button>
                        </div>

                        <div class="apple-progress">
                            <div class="apple-time">2:15 / 5:26</div>
                            <div class="apple-progress-bar">
                                <div class="apple-progress-fill" style="width: 42%"></div>
                            </div>
                        </div>

                        <div class="apple-stations">
                            <h5>Estaciones de Radio</h5>
                            <div class="station-list">
                                <div class="station-item" onclick="playAppleStation('Workout Hits')">
                                    <span class="station-icon">🎵</span>
                                    <span class="station-name">Workout Hits Radio</span>
                                </div>
                                <div class="station-item" onclick="playAppleStation('Energy Boost')">
                                    <span class="station-icon">⚡</span>
                                    <span class="station-name">Energy Boost</span>
                                </div>
                                <div class="station-item" onclick="playAppleStation('Strength Training')">
                                    <span class="station-icon">💪</span>
                                    <span class="station-name">Strength Training</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (service === 'youtubeMusic') {
                return `
                    <div class="youtube-interface">
                        <div class="youtube-video-player">
                            <div class="video-thumbnail">
                                <div class="video-placeholder">📺</div>
                                <div class="video-overlay">
                                    <button class="youtube-play-btn" onclick="toggleYouTubePlayback()">▶️</button>
                                </div>
                            </div>
                            <div class="video-info">
                                <div class="video-title">Unstoppable - Sia (Official Video)</div>
                                <div class="video-artist">Sia • 245M visualizaciones</div>
                            </div>
                        </div>

                        <div class="youtube-controls">
                            <div class="youtube-progress">
                                <div class="youtube-progress-bar">
                                    <div class="youtube-progress-fill" style="width: 28%"></div>
                                </div>
                                <div class="youtube-time">1:02 / 3:37</div>
                            </div>

                            <div class="youtube-buttons">
                                <button class="youtube-btn">👍</button>
                                <button class="youtube-btn">👎</button>
                                <button class="youtube-btn">📱</button>
                                <button class="youtube-btn">🔊</button>
                            </div>
                        </div>

                        <div class="youtube-queue">
                            <h5>Cola de Reproducción</h5>
                            <div class="queue-list">
                                <div class="queue-item" onclick="playYouTubeTrack('Titanium')">
                                    <div class="queue-thumb">🎵</div>
                                    <div class="queue-info">
                                        <div class="queue-title">Titanium</div>
                                        <div class="queue-artist">David Guetta ft. Sia</div>
                                    </div>
                                    <div class="queue-duration">4:05</div>
                                </div>
                                <div class="queue-item" onclick="playYouTubeTrack('Centuries')">
                                    <div class="queue-thumb">🎵</div>
                                    <div class="queue-info">
                                        <div class="queue-title">Centuries</div>
                                        <div class="queue-artist">Fall Out Boy</div>
                                    </div>
                                    <div class="queue-duration">3:46</div>
                                </div>
                                <div class="queue-item" onclick="playYouTubeTrack('Warriors')">
                                    <div class="queue-thumb">🎵</div>
                                    <div class="queue-info">
                                        <div class="queue-title">Warriors</div>
                                        <div class="queue-artist">Imagine Dragons</div>
                                    </div>
                                    <div class="queue-duration">2:50</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // Service-specific playback functions
        function toggleSpotifyPlayback() {
            showNotification('🎵 Reproduciendo en Spotify', 'info');
        }

        function playSpotifyPlaylist(playlistName) {
            showNotification(`♪ Cargando playlist: ${playlistName}`, 'success');
        }

        function toggleApplePlayback() {
            showNotification('🍎 Reproduciendo en Apple Music', 'info');
        }

        function playAppleStation(stationName) {
            showNotification(`📻 Sintonizando: ${stationName}`, 'success');
        }

        function toggleYouTubePlayback() {
            showNotification('📺 Reproduciendo video en YouTube Music', 'info');
        }

        function playYouTubeTrack(trackName) {
            showNotification(`🎬 Cargando: ${trackName}`, 'success');
        }

        function disconnectService(service) {
            musicAuth[service].connected = false;
            musicAuth[service].token = null;
            localStorage.setItem('gymProMusicAuth', JSON.stringify(musicAuth));

            // Reset to default music widget
            loadPlaylist('strength');
            showNotification(`Desconectado de ${service}`, 'info');
        }

        function loadMusicAuth() {
            const saved = localStorage.getItem('gymProMusicAuth');
            if (saved) {
                musicAuth = { ...musicAuth, ...JSON.parse(saved) };
            }
        }

        // Función para resetear conexiones (para debugging)
        function resetAllMusicConnections() {
            musicAuth = {
                spotify: { connected: false, token: null },
                appleMusic: { connected: false, token: null },
                youtubeMusic: { connected: false, token: null }
            };
            localStorage.removeItem('gymProMusicAuth');
            showNotification('Todas las conexiones de música han sido reseteadas', 'info');
            console.log('Conexiones de música reseteadas. Recarga la página.');
        }

        function loadPlaylist(playlistType) {
            currentPlaylist = workoutPlaylists[playlistType];
            currentTrack = 0;
            isPlaying = false;

            updateMusicPlayer();
            showNotification(`Playlist "${currentPlaylist.name}" cargada`, 'success');
        }

        function updateMusicPlayer() {
            if (!currentPlaylist) return;

            const musicWidget = document.querySelector('.music-widget');
            if (musicWidget) {
                const track = currentPlaylist.tracks[currentTrack];
                const serviceIndicator = currentPlaylist.service ? `
                    <div class="current-service">
                        <div class="service-badge ${currentPlaylist.service}">
                            ${getServiceIcon(currentPlaylist.service)}
                            <span>${currentPlaylist.service}</span>
                        </div>
                    </div>
                ` : '';

                musicWidget.innerHTML = `
                    <div class="music-header">
                        <h4><i class="fas fa-music"></i> ${currentPlaylist.name}</h4>
                        <div class="music-header-right">
                            <span class="bpm">${currentPlaylist.bpm} BPM</span>
                            ${serviceIndicator}
                        </div>
                    </div>
                    <div class="current-track">
                        <div class="track-info">
                            <div class="track-title">${track.title}</div>
                            <div class="track-artist">${track.artist}</div>
                        </div>
                        <div class="track-duration">${track.duration}</div>
                    </div>
                    <div class="music-controls">
                        <button onclick="previousTrack()" class="control-btn">⏮️</button>
                        <button onclick="togglePlayback()" class="control-btn main-control">
                            ${isPlaying ? '⏸️' : '▶️'}
                        </button>
                        <button onclick="nextTrack()" class="control-btn">⏭️</button>
                        <button onclick="shufflePlaylist()" class="control-btn">🔀</button>
                        <button onclick="showVolumeControl()" class="control-btn">🔊</button>
                    </div>
                    <div class="music-services">
                        <button onclick="openSpotify()" class="service-btn spotify ${musicAuth.spotify.connected ? 'connected' : ''}">
                            ♪ Spotify
                        </button>
                        <button onclick="openAppleMusic()" class="service-btn apple ${musicAuth.appleMusic.connected ? 'connected' : ''}">
                            🍎 Apple
                        </button>
                        <button onclick="openYouTubeMusic()" class="service-btn youtube ${musicAuth.youtubeMusic.connected ? 'connected' : ''}">
                            📺 YouTube
                        </button>
                    </div>
                    <div class="service-playlists">
                        ${currentMusicService ? '' : '<p class="connect-notice">Conecta un servicio de música para ver playlists</p>'}
                    </div>
                `;
            }
        }

        function showVolumeControl() {
            const volumeModal = document.createElement('div');
            volumeModal.className = 'volume-modal';
            volumeModal.innerHTML = `
                <div class="volume-content">
                    <h4>Control de Volumen</h4>
                    <div class="volume-control">
                        <span>🔇</span>
                        <input type="range" id="volumeSlider" min="0" max="100" value="70" class="volume-slider">
                        <span>🔊</span>
                    </div>
                    <div class="equalizer">
                        <h5>Ecualizador</h5>
                        <div class="eq-controls">
                            <div class="eq-band">
                                <label>Bajos</label>
                                <input type="range" min="-10" max="10" value="0" class="eq-slider">
                            </div>
                            <div class="eq-band">
                                <label>Medios</label>
                                <input type="range" min="-10" max="10" value="0" class="eq-slider">
                            </div>
                            <div class="eq-band">
                                <label>Agudos</label>
                                <input type="range" min="-10" max="10" value="0" class="eq-slider">
                            </div>
                        </div>
                    </div>
                    <button onclick="closeVolumeModal()" class="btn-primary">Cerrar</button>
                </div>
            `;
            document.body.appendChild(volumeModal);

            // Add volume change listener
            document.getElementById('volumeSlider').addEventListener('input', function(e) {
                const volume = e.target.value;
                showNotification(`Volumen: ${volume}%`, 'info');
            });
        }

        function closeVolumeModal() {
            const modal = document.querySelector('.volume-modal');
            if (modal) modal.remove();
        }

        function togglePlayback() {
            if (!currentPlaylist) {
                loadPlaylist('strength');
                return;
            }

            isPlaying = !isPlaying;
            updateMusicPlayer();

            if (isPlaying) {
                showNotification(`▶️ Reproduciendo: ${currentPlaylist.tracks[currentTrack].title}`, 'info');
            } else {
                showNotification('⏸️ Música pausada', 'info');
            }
        }

        function nextTrack() {
            if (!currentPlaylist) return;

            currentTrack = (currentTrack + 1) % currentPlaylist.tracks.length;
            updateMusicPlayer();

            if (isPlaying) {
                showNotification(`⏭️ ${currentPlaylist.tracks[currentTrack].title}`, 'info');
            }
        }

        function previousTrack() {
            if (!currentPlaylist) return;

            currentTrack = currentTrack === 0 ? currentPlaylist.tracks.length - 1 : currentTrack - 1;
            updateMusicPlayer();

            if (isPlaying) {
                showNotification(`⏮️ ${currentPlaylist.tracks[currentTrack].title}`, 'info');
            }
        }

        function shufflePlaylist() {
            if (!currentPlaylist) return;

            // Simple shuffle algorithm
            for (let i = currentPlaylist.tracks.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [currentPlaylist.tracks[i], currentPlaylist.tracks[j]] = [currentPlaylist.tracks[j], currentPlaylist.tracks[i]];
            }

            currentTrack = 0;
            updateMusicPlayer();
            showNotification('🔀 Playlist mezclada', 'info');
        }

        // Auto-advance tracks when playing
        function startMusicTimer() {
            if (isPlaying && currentPlaylist) {
                const trackDuration = currentPlaylist.tracks[currentTrack].duration;
                const [minutes, seconds] = trackDuration.split(':').map(Number);
                const totalSeconds = (minutes * 60 + seconds) * 1000;

                setTimeout(() => {
                    if (isPlaying) {
                        nextTrack();
                        startMusicTimer();
                    }
                }, totalSeconds);
            }
        }

        // Connect music to workout intensity
        function adaptMusicToWorkout(intensity) {
            if (intensity === 'high') {
                loadPlaylist('strength');
            } else if (intensity === 'medium') {
                loadPlaylist('cardio');
            } else {
                loadPlaylist('yoga');
            }
        }

        // Rating functionality
        let currentRating = 0;

        function rateStar(rating) {
            currentRating = rating;
            const stars = document.querySelectorAll('.stars-rating i');

            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        function submitRating() {
            if (currentRating > 0) {
                showNotification(`¡Gracias por calificar con ${currentRating} estrellas!`, 'success');
                // Reset rating
                currentRating = 0;
                document.querySelectorAll('.stars-rating i').forEach(star => {
                    star.classList.remove('active');
                });
                document.querySelector('.rating-textarea').value = '';
            } else {
                showNotification('Por favor selecciona una calificación', 'warning');
            }
        }

        // Grant internet access
        function grantAccess() {
            const progress = (completedExercises / totalExercises) * 100;

            if (progress < 100) {
                showNotification('Completa todos los ejercicios primero', 'warning');
                return;
            }

            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('accessGranted').style.display = 'block';

            // In real implementation, this would redirect to internet
            setTimeout(() => {
                // window.location.href = 'https://www.google.com';
            }, 3000);
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');

            // Set message
            notificationText.textContent = message;

            // Set color based on type
            switch(type) {
                case 'success':
                    notification.style.background = 'var(--success)';
                    break;
                case 'error':
                    notification.style.background = 'var(--danger)';
                    break;
                case 'warning':
                    notification.style.background = 'var(--warning)';
                    break;
                case 'info':
                    notification.style.background = 'var(--primary)';
                    break;
            }

            // Show notification
            notification.style.display = 'flex';

            // Hide after 3 seconds
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Add hover effects to exercise items
        // Mensaje de debug para el desarrollador
        console.log('🎵 Sistema de Música Debug:');
        console.log('Para resetear todas las conexiones: resetAllMusicConnections()');
        console.log('Estado actual de música:', musicAuth);

        document.addEventListener('DOMContentLoaded', function() {
            // Cargar datos guardados
            loadWorkoutData();
            loadMusicAuth();

            const exerciseItems = document.querySelectorAll('.exercise-item');

            exerciseItems.forEach(item => {
                item.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('completed')) {
                        this.style.transform = 'translateX(10px)';
                    }
                });

                item.addEventListener('mouseleave', function() {
                    if (!this.classList.contains('completed')) {
                        this.style.transform = 'translateX(0)';
                    }
                });
            });

            // Initialize workout data when page loads
            loadWorkoutData();

            // Initialize user statistics
            loadUserStats();

            // Initialize timer state
            loadTimerState();

            // Initialize music authentication
            loadMusicAuth();

            // Initialize music player
            loadPlaylist('strength');

            // Update stats every minute
            setInterval(updateWorkoutStats, 60000);
        });
    </script>
</body>
</html>